<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì œ15ê°•: ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„ì™€ ìµœì í™” | Cursor AI ë§ˆìŠ¤í„° í´ë˜ìŠ¤</title>
    <link rel="stylesheet" href="../assets/lesson-style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="lesson-container">
        <header class="lesson-header">
            <div class="lesson-title">
                <h1><i class="fas fa-database"></i> ì œ15ê°•: ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„ì™€ ìµœì í™”</h1>
                <p class="lesson-subtitle">AIì™€ í•¨ê»˜í•˜ëŠ” íš¨ìœ¨ì ì¸ ë°ì´í„° ëª¨ë¸ë§ê³¼ ì¿¼ë¦¬ ìµœì í™”</p>
            </div>
            <div class="lesson-meta">
                <span class="difficulty"><i class="fas fa-signal"></i> ë‚œì´ë„: ì¤‘ê¸‰</span>
                <span class="duration"><i class="fas fa-clock"></i> ì˜ˆìƒ ì‹œê°„: 50ë¶„</span>
                <span class="category"><i class="fas fa-folder"></i> ì¹´í…Œê³ ë¦¬: ì¤‘ê¸‰</span>
            </div>
        </header>

        <nav class="lesson-nav">
            <a href="lesson14.html" class="nav-link prev">
                <i class="fas fa-chevron-left"></i> ì´ì „ ê°•ì˜
            </a>
            <span class="nav-title">ì œ15ê°•: ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„ì™€ ìµœì í™”</span>
            <a href="lesson16.html" class="nav-link next">
                ë‹¤ìŒ ê°•ì˜ <i class="fas fa-chevron-right"></i>
            </a>
        </nav>

        <main class="lesson-content">
            <section class="learning-objectives">
                <h2><i class="fas fa-bullseye"></i> í•™ìŠµ ëª©í‘œ</h2>
                <ul>
                    <li>AI ê¸°ë°˜ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ì„¤ê³„ ë°©ë²• ìµíˆê¸°</li>
                    <li>ê´€ê³„í˜• ë° NoSQL ë°ì´í„°ë² ì´ìŠ¤ ì„ íƒ ê¸°ì¤€ ì´í•´í•˜ê¸°</li>
                    <li>ì¸ë±ì‹± ì „ëµê³¼ ì¿¼ë¦¬ ìµœì í™” ê¸°ë²• ë§ˆìŠ¤í„°í•˜ê¸°</li>
                    <li>ë§ˆì´ê·¸ë ˆì´ì…˜ê³¼ ë²„ì „ ê´€ë¦¬ ì‹œìŠ¤í…œ êµ¬ì¶•í•˜ê¸°</li>
                    <li>ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ê³¼ íŠœë‹ ë°©ë²• í•™ìŠµí•˜ê¸°</li>
                </ul>
            </section>

            <section class="content-section">
                <h2><i class="fas fa-sitemap"></i> AI ê¸°ë°˜ ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„</h2>
                
                <div class="info-box">
                    <p>Cursor AIëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ ìš”êµ¬ì‚¬í•­ì„ ë¶„ì„í•˜ì—¬ ìµœì ì˜ ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¡°ë¥¼ ì„¤ê³„í•©ë‹ˆë‹¤. ì •ê·œí™”, ì¸ë±ì‹±, ê´€ê³„ ì„¤ì •ê¹Œì§€ ëª¨ë“  ê³¼ì •ì„ ìë™í™”í•˜ì—¬ í™•ì¥ ê°€ëŠ¥í•˜ê³  íš¨ìœ¨ì ì¸ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ êµ¬ì¶•í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                </div>

                <h3>E-Commerce í”Œë«í¼ ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„</h3>
                <div class="db-design-example">
                    <div class="requirements">
                        <h4>ìš”êµ¬ì‚¬í•­</h4>
                        <ul>
                            <li>ì‚¬ìš©ì ê´€ë¦¬ (êµ¬ë§¤ì/íŒë§¤ì)</li>
                            <li>ìƒí’ˆ ì¹´íƒˆë¡œê·¸ì™€ ì¬ê³  ê´€ë¦¬</li>
                            <li>ì£¼ë¬¸ ë° ê²°ì œ ì²˜ë¦¬</li>
                            <li>ë¦¬ë·°ì™€ í‰ì  ì‹œìŠ¤í…œ</li>
                            <li>ì¥ë°”êµ¬ë‹ˆì™€ ìœ„ì‹œë¦¬ìŠ¤íŠ¸</li>
                        </ul>
                    </div>

                    <div class="ai-generated-schema">
                        <h4>AIê°€ ìƒì„±í•œ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ</h4>
                        <pre><code>-- PostgreSQL Schema

-- ì‚¬ìš©ì ê´€ë ¨ í…Œì´ë¸”
CREATE TABLE users (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    email VARCHAR(255) UNIQUE NOT NULL,
    password_hash VARCHAR(255) NOT NULL,
    role VARCHAR(20) NOT NULL CHECK (role IN ('buyer', 'seller', 'admin')),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    is_active BOOLEAN DEFAULT true,
    email_verified BOOLEAN DEFAULT false
);

CREATE TABLE user_profiles (
    user_id UUID PRIMARY KEY REFERENCES users(id) ON DELETE CASCADE,
    first_name VARCHAR(100),
    last_name VARCHAR(100),
    phone VARCHAR(20),
    avatar_url VARCHAR(500),
    bio TEXT,
    date_of_birth DATE,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- íŒë§¤ì ì •ë³´
CREATE TABLE sellers (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID UNIQUE NOT NULL REFERENCES users(id) ON DELETE CASCADE,
    store_name VARCHAR(255) NOT NULL,
    store_slug VARCHAR(255) UNIQUE NOT NULL,
    description TEXT,
    logo_url VARCHAR(500),
    rating DECIMAL(3,2) DEFAULT 0,
    total_sales INTEGER DEFAULT 0,
    is_verified BOOLEAN DEFAULT false,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- ì¹´í…Œê³ ë¦¬ (ê³„ì¸µ êµ¬ì¡°)
CREATE TABLE categories (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    name VARCHAR(100) NOT NULL,
    slug VARCHAR(100) UNIQUE NOT NULL,
    parent_id UUID REFERENCES categories(id) ON DELETE CASCADE,
    level INTEGER NOT NULL DEFAULT 0,
    path TEXT NOT NULL, -- ì˜ˆ: /electronics/computers/laptops
    is_active BOOLEAN DEFAULT true,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- ìƒí’ˆ í…Œì´ë¸”
CREATE TABLE products (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    seller_id UUID NOT NULL REFERENCES sellers(id) ON DELETE CASCADE,
    category_id UUID NOT NULL REFERENCES categories(id),
    name VARCHAR(255) NOT NULL,
    slug VARCHAR(255) UNIQUE NOT NULL,
    description TEXT,
    price DECIMAL(10,2) NOT NULL CHECK (price >= 0),
    compare_at_price DECIMAL(10,2),
    cost DECIMAL(10,2),
    sku VARCHAR(100) UNIQUE,
    barcode VARCHAR(100),
    weight INTEGER, -- in grams
    status VARCHAR(20) DEFAULT 'active' CHECK (status IN ('active', 'draft', 'archived')),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- ìƒí’ˆ ì´ë¯¸ì§€
CREATE TABLE product_images (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    product_id UUID NOT NULL REFERENCES products(id) ON DELETE CASCADE,
    url VARCHAR(500) NOT NULL,
    alt_text VARCHAR(255),
    position INTEGER DEFAULT 0,
    is_primary BOOLEAN DEFAULT false
);

-- ìƒí’ˆ ì˜µì…˜ (ìƒ‰ìƒ, í¬ê¸° ë“±)
CREATE TABLE product_variants (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    product_id UUID NOT NULL REFERENCES products(id) ON DELETE CASCADE,
    sku VARCHAR(100) UNIQUE,
    price DECIMAL(10,2),
    compare_at_price DECIMAL(10,2),
    inventory_quantity INTEGER DEFAULT 0,
    options JSONB NOT NULL, -- {"color": "red", "size": "L"}
    is_available BOOLEAN DEFAULT true
);

-- ì¬ê³  ì¶”ì 
CREATE TABLE inventory_movements (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    variant_id UUID NOT NULL REFERENCES product_variants(id),
    quantity INTEGER NOT NULL,
    type VARCHAR(20) NOT NULL CHECK (type IN ('purchase', 'sale', 'return', 'adjustment')),
    reference_id UUID, -- order_id or adjustment_id
    notes TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- ì£¼ë¬¸ í…Œì´ë¸”
CREATE TABLE orders (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    order_number VARCHAR(20) UNIQUE NOT NULL,
    user_id UUID NOT NULL REFERENCES users(id),
    status VARCHAR(20) DEFAULT 'pending' 
        CHECK (status IN ('pending', 'processing', 'shipped', 'delivered', 'cancelled', 'refunded')),
    subtotal DECIMAL(10,2) NOT NULL,
    tax_amount DECIMAL(10,2) DEFAULT 0,
    shipping_amount DECIMAL(10,2) DEFAULT 0,
    discount_amount DECIMAL(10,2) DEFAULT 0,
    total_amount DECIMAL(10,2) NOT NULL,
    currency VARCHAR(3) DEFAULT 'USD',
    shipping_address JSONB,
    billing_address JSONB,
    notes TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- ì£¼ë¬¸ ìƒí’ˆ
CREATE TABLE order_items (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    order_id UUID NOT NULL REFERENCES orders(id) ON DELETE CASCADE,
    product_id UUID NOT NULL REFERENCES products(id),
    variant_id UUID REFERENCES product_variants(id),
    seller_id UUID NOT NULL REFERENCES sellers(id),
    quantity INTEGER NOT NULL CHECK (quantity > 0),
    price DECIMAL(10,2) NOT NULL,
    discount_amount DECIMAL(10,2) DEFAULT 0,
    tax_amount DECIMAL(10,2) DEFAULT 0,
    total_amount DECIMAL(10,2) NOT NULL
);

-- ë¦¬ë·°ì™€ í‰ì 
CREATE TABLE reviews (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    product_id UUID NOT NULL REFERENCES products(id) ON DELETE CASCADE,
    user_id UUID NOT NULL REFERENCES users(id),
    order_item_id UUID REFERENCES order_items(id),
    rating INTEGER NOT NULL CHECK (rating >= 1 AND rating <= 5),
    title VARCHAR(255),
    comment TEXT,
    is_verified_purchase BOOLEAN DEFAULT false,
    helpful_count INTEGER DEFAULT 0,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    UNIQUE(product_id, user_id, order_item_id)
);

-- ì¥ë°”êµ¬ë‹ˆ
CREATE TABLE cart_items (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
    product_id UUID NOT NULL REFERENCES products(id),
    variant_id UUID REFERENCES product_variants(id),
    quantity INTEGER NOT NULL DEFAULT 1,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    UNIQUE(user_id, product_id, variant_id)
);

-- ì¸ë±ìŠ¤ ìƒì„±
CREATE INDEX idx_users_email ON users(email);
CREATE INDEX idx_products_seller ON products(seller_id);
CREATE INDEX idx_products_category ON products(category_id);
CREATE INDEX idx_products_status ON products(status) WHERE status = 'active';
CREATE INDEX idx_orders_user ON orders(user_id);
CREATE INDEX idx_orders_status ON orders(status);
CREATE INDEX idx_order_items_order ON order_items(order_id);
CREATE INDEX idx_reviews_product ON reviews(product_id);
CREATE INDEX idx_reviews_user ON reviews(user_id);
CREATE INDEX idx_cart_items_user ON cart_items(user_id);

-- ì „ë¬¸ ê²€ìƒ‰ì„ ìœ„í•œ ì¸ë±ìŠ¤
CREATE INDEX idx_products_search ON products USING gin(
    to_tsvector('english', name || ' ' || COALESCE(description, ''))
);

-- íŠ¸ë¦¬ê±°: ì—…ë°ì´íŠ¸ ì‹œê°„ ìë™ ê°±ì‹ 
CREATE OR REPLACE FUNCTION update_updated_at_column()
RETURNS TRIGGER AS $$
BEGIN
    NEW.updated_at = CURRENT_TIMESTAMP;
    RETURN NEW;
END;
$$ language 'plpgsql';

CREATE TRIGGER update_users_updated_at BEFORE UPDATE ON users
    FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();

CREATE TRIGGER update_products_updated_at BEFORE UPDATE ON products
    FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();</code></pre>
                    </div>
                </div>
            </section>

            <section class="content-section">
                <h2><i class="fas fa-bolt"></i> ì¿¼ë¦¬ ìµœì í™” ì „ëµ</h2>

                <div class="query-optimization">
                    <h3>AIê°€ ë¶„ì„í•œ ì¿¼ë¦¬ ì„±ëŠ¥ ê°œì„ </h3>
                    
                    <div class="optimization-example">
                        <div class="slow-query">
                            <h4>âŒ ëŠë¦° ì¿¼ë¦¬</h4>
                            <pre><code>-- ì¸ê¸° ìƒí’ˆ ì¡°íšŒ (N+1 ë¬¸ì œ)
SELECT p.*, s.store_name, 
       (SELECT COUNT(*) FROM reviews r WHERE r.product_id = p.id) as review_count,
       (SELECT AVG(rating) FROM reviews r WHERE r.product_id = p.id) as avg_rating,
       (SELECT COUNT(*) FROM order_items oi WHERE oi.product_id = p.id) as sales_count
FROM products p
JOIN sellers s ON p.seller_id = s.id
WHERE p.status = 'active'
ORDER BY sales_count DESC
LIMIT 20;</code></pre>
                            <div class="query-plan">
                                <p>ì‹¤í–‰ ê³„íš: ê° ìƒí’ˆë§ˆë‹¤ 3ê°œì˜ ì„œë¸Œì¿¼ë¦¬ ì‹¤í–‰ (ì´ 60ê°œì˜ ì¶”ê°€ ì¿¼ë¦¬)</p>
                                <p>ì˜ˆìƒ ì‹¤í–‰ ì‹œê°„: ~500ms</p>
                            </div>
                        </div>

                        <div class="optimized-query">
                            <h4>âœ… ìµœì í™”ëœ ì¿¼ë¦¬</h4>
                            <pre><code>-- CTEì™€ JOINì„ í™œìš©í•œ ìµœì í™”
WITH product_stats AS (
    SELECT 
        p.id,
        COUNT(DISTINCT r.id) as review_count,
        AVG(r.rating) as avg_rating,
        COUNT(DISTINCT oi.id) as sales_count
    FROM products p
    LEFT JOIN reviews r ON r.product_id = p.id
    LEFT JOIN order_items oi ON oi.product_id = p.id
    WHERE p.status = 'active'
    GROUP BY p.id
),
ranked_products AS (
    SELECT 
        p.*,
        s.store_name,
        ps.review_count,
        ps.avg_rating,
        ps.sales_count,
        ROW_NUMBER() OVER (ORDER BY ps.sales_count DESC) as rank
    FROM products p
    JOIN sellers s ON p.seller_id = s.id
    JOIN product_stats ps ON ps.id = p.id
)
SELECT * FROM ranked_products
WHERE rank <= 20;</code></pre>
                            <div class="query-plan">
                                <p>ì‹¤í–‰ ê³„íš: ë‹¨ì¼ ì¿¼ë¦¬ë¡œ ëª¨ë“  ë°ì´í„° ì¡°íšŒ</p>
                                <p>ì˜ˆìƒ ì‹¤í–‰ ì‹œê°„: ~50ms (10ë°° í–¥ìƒ)</p>
                            </div>
                        </div>
                    </div>

                    <h3>ì¸ë±ì‹± ì „ëµ</h3>
                    <div class="indexing-strategy">
                        <h4>ë³µí•© ì¸ë±ìŠ¤ ì„¤ê³„</h4>
                        <pre><code>-- ì£¼ë¬¸ ì¡°íšŒ ìµœì í™”ë¥¼ ìœ„í•œ ë³µí•© ì¸ë±ìŠ¤
CREATE INDEX idx_orders_user_status_created 
ON orders(user_id, status, created_at DESC);

-- ìƒí’ˆ ê²€ìƒ‰ ìµœì í™”
CREATE INDEX idx_products_category_status_price 
ON products(category_id, status, price) 
WHERE status = 'active';

-- ë¦¬ë·° ì§‘ê³„ ìµœì í™”
CREATE INDEX idx_reviews_product_rating 
ON reviews(product_id, rating) 
INCLUDE (created_at);

-- íŒë§¤ìë³„ ìƒí’ˆ ì¡°íšŒ ìµœì í™”
CREATE INDEX idx_products_seller_status_created 
ON products(seller_id, status, created_at DESC);

-- ë¶€ë¶„ ì¸ë±ìŠ¤ (íŠ¹ì • ì¡°ê±´ë§Œ ì¸ë±ì‹±)
CREATE INDEX idx_high_value_orders 
ON orders(total_amount) 
WHERE total_amount > 1000;

-- JSONB í•„ë“œ ì¸ë±ì‹±
CREATE INDEX idx_variant_options 
ON product_variants USING gin(options);

-- ì „ë¬¸ ê²€ìƒ‰ ìµœì í™”
CREATE INDEX idx_products_fts ON products 
USING gin(to_tsvector('english', 
    name || ' ' || COALESCE(description, '') || ' ' || sku
));</code></pre>
                    </div>
                </div>
            </section>

            <section class="content-section">
                <h2><i class="fas fa-exchange-alt"></i> NoSQL vs SQL ì„ íƒ ê°€ì´ë“œ</h2>

                <div class="db-comparison">
                    <h3>AI ê¸°ë°˜ ë°ì´í„°ë² ì´ìŠ¤ ì„ íƒ</h3>
                    
                    <div class="db-decision-tree">
                        <div class="use-case-analysis">
                            <h4>MongoDB ìŠ¤í‚¤ë§ˆ (NoSQL)</h4>
                            <pre><code>// ìƒí’ˆ ì»¬ë ‰ì…˜ - ìœ ì—°í•œ ìŠ¤í‚¤ë§ˆ
{
  "_id": ObjectId("..."),
  "name": "Gaming Laptop",
  "slug": "gaming-laptop-rtx-4090",
  "seller": {
    "id": ObjectId("..."),
    "name": "TechStore",
    "rating": 4.8
  },
  "category": {
    "path": ["Electronics", "Computers", "Laptops"],
    "id": ObjectId("...")
  },
  "pricing": {
    "currency": "USD",
    "price": 2499.99,
    "compareAtPrice": 2999.99,
    "discountPercentage": 17
  },
  "variants": [
    {
      "sku": "GL-RTX4090-16GB",
      "options": {
        "ram": "16GB",
        "storage": "1TB SSD",
        "color": "Black"
      },
      "inventory": {
        "quantity": 15,
        "reserved": 3,
        "available": 12
      },
      "price": 2499.99
    }
  ],
  "images": [
    {
      "url": "https://...",
      "alt": "Front view",
      "isPrimary": true
    }
  ],
  "specifications": {
    "processor": "Intel i9-13900K",
    "graphics": "NVIDIA RTX 4090",
    "display": {
      "size": "17.3 inches",
      "resolution": "2560x1440",
      "refreshRate": "165Hz"
    },
    "ports": ["USB-C", "HDMI 2.1", "Thunderbolt 4"]
  },
  "reviews": {
    "average": 4.7,
    "count": 128,
    "distribution": {
      "5": 89,
      "4": 28,
      "3": 8,
      "2": 2,
      "1": 1
    }
  },
  "metadata": {
    "createdAt": ISODate("..."),
    "updatedAt": ISODate("..."),
    "tags": ["gaming", "high-performance", "rtx-4090"],
    "searchKeywords": ["gaming laptop", "rtx 4090", "high fps"]
  }
}

// ì¸ë±ìŠ¤ ì „ëµ
db.products.createIndex({ "slug": 1 }, { unique: true });
db.products.createIndex({ "seller.id": 1, "metadata.createdAt": -1 });
db.products.createIndex({ 
  "name": "text", 
  "specifications": "text", 
  "metadata.searchKeywords": "text" 
});
db.products.createIndex({ "category.path": 1 });
db.products.createIndex({ 
  "pricing.price": 1, 
  "reviews.average": -1 
});</code></pre>
                        </div>

                        <div class="decision-criteria">
                            <h4>ì„ íƒ ê¸°ì¤€</h4>
                            <table>
                                <thead>
                                    <tr>
                                        <th>ìš”êµ¬ì‚¬í•­</th>
                                        <th>SQL (PostgreSQL)</th>
                                        <th>NoSQL (MongoDB)</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>ë³µì¡í•œ ê´€ê³„</td>
                                        <td>âœ… ë›°ì–´ë‚¨</td>
                                        <td>âš ï¸ ì œí•œì </td>
                                    </tr>
                                    <tr>
                                        <td>ACID íŠ¸ëœì­ì…˜</td>
                                        <td>âœ… ì™„ë²½ ì§€ì›</td>
                                        <td>âš ï¸ ë¶€ë¶„ ì§€ì›</td>
                                    </tr>
                                    <tr>
                                        <td>ìŠ¤í‚¤ë§ˆ ìœ ì—°ì„±</td>
                                        <td>âš ï¸ ì—„ê²©í•¨</td>
                                        <td>âœ… ë§¤ìš° ìœ ì—°</td>
                                    </tr>
                                    <tr>
                                        <td>ìˆ˜í‰ í™•ì¥</td>
                                        <td>âš ï¸ ë³µì¡í•¨</td>
                                        <td>âœ… ì‰¬ì›€</td>
                                    </tr>
                                    <tr>
                                        <td>ë³µì¡í•œ ì¿¼ë¦¬</td>
                                        <td>âœ… SQL íŒŒì›Œ</td>
                                        <td>âš ï¸ ì œí•œì </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </section>

            <section class="content-section">
                <h2><i class="fas fa-sync-alt"></i> ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜</h2>

                <div class="migration-management">
                    <h3>ë§ˆì´ê·¸ë ˆì´ì…˜ ìë™í™”</h3>
                    
                    <pre><code>// migrations/20240115_add_product_reviews.js
export const up = async (db) => {
    // ë¦¬ë·° ìš”ì•½ í…Œì´ë¸” ì¶”ê°€
    await db.createTable('review_summaries', {
        id: {
            type: 'uuid',
            primaryKey: true,
            defaultValue: db.raw('gen_random_uuid()')
        },
        product_id: {
            type: 'uuid',
            notNull: true,
            references: 'products.id',
            onDelete: 'CASCADE'
        },
        total_reviews: {
            type: 'integer',
            defaultValue: 0
        },
        average_rating: {
            type: 'decimal(3,2)',
            defaultValue: 0
        },
        rating_distribution: {
            type: 'jsonb',
            defaultValue: '{}'
        },
        last_updated: {
            type: 'timestamp',
            defaultValue: db.raw('CURRENT_TIMESTAMP')
        }
    });

    // ì¸ë±ìŠ¤ ì¶”ê°€
    await db.addIndex('review_summaries', ['product_id'], {
        unique: true,
        name: 'idx_review_summaries_product'
    });

    // ê¸°ì¡´ ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜
    await db.raw(`
        INSERT INTO review_summaries (product_id, total_reviews, average_rating, rating_distribution)
        SELECT 
            p.id,
            COUNT(r.id),
            COALESCE(AVG(r.rating), 0),
            jsonb_build_object(
                '5', COUNT(CASE WHEN r.rating = 5 THEN 1 END),
                '4', COUNT(CASE WHEN r.rating = 4 THEN 1 END),
                '3', COUNT(CASE WHEN r.rating = 3 THEN 1 END),
                '2', COUNT(CASE WHEN r.rating = 2 THEN 1 END),
                '1', COUNT(CASE WHEN r.rating = 1 THEN 1 END)
            )
        FROM products p
        LEFT JOIN reviews r ON r.product_id = p.id
        GROUP BY p.id
    `);

    // íŠ¸ë¦¬ê±° ìƒì„±: ë¦¬ë·° ì¶”ê°€/ìˆ˜ì • ì‹œ ìë™ ì—…ë°ì´íŠ¸
    await db.raw(`
        CREATE OR REPLACE FUNCTION update_review_summary()
        RETURNS TRIGGER AS $$
        BEGIN
            WITH stats AS (
                SELECT 
                    COUNT(*) as total,
                    AVG(rating) as avg_rating,
                    jsonb_build_object(
                        '5', COUNT(CASE WHEN rating = 5 THEN 1 END),
                        '4', COUNT(CASE WHEN rating = 4 THEN 1 END),
                        '3', COUNT(CASE WHEN rating = 3 THEN 1 END),
                        '2', COUNT(CASE WHEN rating = 2 THEN 1 END),
                        '1', COUNT(CASE WHEN rating = 1 THEN 1 END)
                    ) as distribution
                FROM reviews
                WHERE product_id = COALESCE(NEW.product_id, OLD.product_id)
            )
            INSERT INTO review_summaries (product_id, total_reviews, average_rating, rating_distribution)
            VALUES (COALESCE(NEW.product_id, OLD.product_id), 
                    (SELECT total FROM stats),
                    (SELECT avg_rating FROM stats),
                    (SELECT distribution FROM stats))
            ON CONFLICT (product_id) DO UPDATE SET
                total_reviews = EXCLUDED.total_reviews,
                average_rating = EXCLUDED.average_rating,
                rating_distribution = EXCLUDED.rating_distribution,
                last_updated = CURRENT_TIMESTAMP;
            
            RETURN NEW;
        END;
        $$ LANGUAGE plpgsql;

        CREATE TRIGGER trigger_update_review_summary
        AFTER INSERT OR UPDATE OR DELETE ON reviews
        FOR EACH ROW EXECUTE FUNCTION update_review_summary();
    `);
};

export const down = async (db) => {
    await db.raw('DROP TRIGGER IF EXISTS trigger_update_review_summary ON reviews');
    await db.raw('DROP FUNCTION IF EXISTS update_review_summary()');
    await db.dropTable('review_summaries');
};</code></pre>
                </div>
            </section>

            <section class="content-section">
                <h2><i class="fas fa-tachometer-alt"></i> ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ê³¼ íŠœë‹</h2>

                <div class="performance-monitoring">
                    <h3>ì¿¼ë¦¬ ì„±ëŠ¥ ë¶„ì„</h3>
                    
                    <pre><code>-- ëŠë¦° ì¿¼ë¦¬ ì°¾ê¸°
SELECT 
    query,
    calls,
    total_time,
    mean_time,
    stddev_time,
    rows
FROM pg_stat_statements
WHERE query NOT LIKE '%pg_stat_statements%'
ORDER BY mean_time DESC
LIMIT 10;

-- ì¸ë±ìŠ¤ ì‚¬ìš©ë¥  í™•ì¸
SELECT 
    schemaname,
    tablename,
    indexname,
    idx_scan,
    idx_tup_read,
    idx_tup_fetch,
    pg_size_pretty(pg_relation_size(indexrelid)) as index_size
FROM pg_stat_user_indexes
ORDER BY idx_scan ASC;

-- í…Œì´ë¸” í¬ê¸°ì™€ íŒ½ì°½ë„
SELECT
    schemaname,
    tablename,
    pg_size_pretty(pg_total_relation_size(schemaname||'.'||tablename)) as size,
    n_live_tup,
    n_dead_tup,
    ROUND(100.0 * n_dead_tup / NULLIF(n_live_tup + n_dead_tup, 0), 2) as dead_pct
FROM pg_stat_user_tables
ORDER BY pg_total_relation_size(schemaname||'.'||tablename) DESC;

-- ìºì‹œ íˆíŠ¸ìœ¨
SELECT 
    sum(heap_blks_read) as heap_read,
    sum(heap_blks_hit) as heap_hit,
    ROUND(100.0 * sum(heap_blks_hit) / 
          NULLIF(sum(heap_blks_hit) + sum(heap_blks_read), 0), 2) as cache_hit_ratio
FROM pg_statio_user_tables;</code></pre>

                    <h3>ìë™ ìµœì í™” ìŠ¤í¬ë¦½íŠ¸</h3>
                    <pre><code>// ë°ì´í„°ë² ì´ìŠ¤ ìµœì í™” ìë™í™”
class DatabaseOptimizer {
    async analyzeAndOptimize() {
        const issues = await this.identifyPerformanceIssues();
        
        for (const issue of issues) {
            switch (issue.type) {
                case 'MISSING_INDEX':
                    await this.createIndex(issue);
                    break;
                case 'UNUSED_INDEX':
                    await this.dropIndex(issue);
                    break;
                case 'TABLE_BLOAT':
                    await this.vacuumTable(issue);
                    break;
                case 'SLOW_QUERY':
                    await this.optimizeQuery(issue);
                    break;
            }
        }
    }

    async identifyPerformanceIssues() {
        const issues = [];

        // ì¸ë±ìŠ¤ê°€ í•„ìš”í•œ ì¿¼ë¦¬ ì°¾ê¸°
        const missingIndexes = await db.query(`
            SELECT 
                schemaname,
                tablename,
                attname,
                n_distinct,
                correlation
            FROM pg_stats
            WHERE schemaname = 'public'
            AND n_distinct > 100
            AND correlation < 0.1
            AND tablename || '.' || attname NOT IN (
                SELECT tablename || '.' || column_name
                FROM information_schema.constraint_column_usage
            )
        `);

        // ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” ì¸ë±ìŠ¤ ì°¾ê¸°
        const unusedIndexes = await db.query(`
            SELECT 
                schemaname,
                tablename,
                indexname
            FROM pg_stat_user_indexes
            WHERE idx_scan = 0
            AND indexrelid NOT IN (
                SELECT conindid FROM pg_constraint
            )
            AND pg_relation_size(indexrelid) > 1048576 -- 1MB ì´ìƒ
        `);

        return issues;
    }

    async createIndex(issue) {
        const indexName = `idx_${issue.table}_${issue.column}`;
        const sql = `CREATE INDEX CONCURRENTLY ${indexName} 
                     ON ${issue.table}(${issue.column})`;
        
        console.log(`Creating index: ${indexName}`);
        await db.query(sql);
    }
}</code></pre>
                </div>
            </section>

            <section class="practice">
                <h2><i class="fas fa-laptop-code"></i> ì‹¤ìŠµ: ì†Œì…œ ë¯¸ë””ì–´ ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„</h2>

                <div class="practice-content">
                    <h3>Instagram í´ë¡  ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¶•</h3>
                    <p>AIì™€ í•¨ê»˜ í™•ì¥ ê°€ëŠ¥í•œ ì†Œì…œ ë¯¸ë””ì–´ í”Œë«í¼ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì„¤ê³„í•´ë´…ì‹œë‹¤.</p>

                    <div class="practice-requirements">
                        <h4>ê¸°ëŠ¥ ìš”êµ¬ì‚¬í•­</h4>
                        <ul>
                            <li>ì‚¬ìš©ì í”„ë¡œí•„ê³¼ íŒ”ë¡œìš° ì‹œìŠ¤í…œ</li>
                            <li>ê²Œì‹œë¬¼ (ì‚¬ì§„/ë¹„ë””ì˜¤) ì—…ë¡œë“œ</li>
                            <li>ì¢‹ì•„ìš”ì™€ ëŒ“ê¸€</li>
                            <li>ìŠ¤í† ë¦¬ (24ì‹œê°„ í›„ ì‚­ì œ)</li>
                            <li>ë‹¤ì´ë ‰íŠ¸ ë©”ì‹œì§€</li>
                            <li>í•´ì‹œíƒœê·¸ì™€ ë©˜ì…˜</li>
                            <li>ì•Œë¦¼ ì‹œìŠ¤í…œ</li>
                        </ul>
                    </div>

                    <div class="practice-steps">
                        <h4>ì„¤ê³„ ë‹¨ê³„</h4>
                        
                        <ol>
                            <li>
                                <strong>ë°ì´í„° ëª¨ë¸ë§</strong>
                                <p>Chat: "Instagram í´ë¡ ì„ ìœ„í•œ ER ë‹¤ì´ì–´ê·¸ë¨ê³¼ í…Œì´ë¸” êµ¬ì¡°ë¥¼ ì„¤ê³„í•´ì¤˜"</p>
                            </li>
                            <li>
                                <strong>ìŠ¤í‚¤ë§ˆ ìƒì„±</strong>
                                <p>Composer: "PostgreSQLê³¼ Redisë¥¼ ì¡°í•©í•œ í•˜ì´ë¸Œë¦¬ë“œ ìŠ¤í‚¤ë§ˆë¥¼ ë§Œë“¤ì–´ì¤˜"</p>
                            </li>
                            <li>
                                <strong>ì¸ë±ì‹± ì „ëµ</strong>
                                <p>AI: "í”¼ë“œ ìƒì„±ê³¼ ê²€ìƒ‰ì„ ìœ„í•œ ìµœì ì˜ ì¸ë±ìŠ¤ë¥¼ ì„¤ê³„í•´ì¤˜"</p>
                            </li>
                            <li>
                                <strong>ìƒ¤ë”© ì „ëµ</strong>
                                <p>ê³ ê¸‰: "ìˆ˜ë°±ë§Œ ì‚¬ìš©ìë¥¼ ìœ„í•œ ë°ì´í„°ë² ì´ìŠ¤ ìƒ¤ë”© ì „ëµì„ ì œì•ˆí•´ì¤˜"</p>
                            </li>
                        </ol>
                    </div>

                    <div class="performance-goals">
                        <h4>ì„±ëŠ¥ ëª©í‘œ</h4>
                        <ul>
                            <li>í”¼ë“œ ë¡œë”©: < 100ms</li>
                            <li>ê²Œì‹œë¬¼ ì—…ë¡œë“œ: < 500ms</li>
                            <li>ê²€ìƒ‰ ì‘ë‹µ: < 200ms</li>
                            <li>ë™ì‹œ ì ‘ì†ì: 100,000+</li>
                        </ul>
                    </div>
                </div>
            </section>

            <section class="summary">
                <h2><i class="fas fa-check-circle"></i> í•µì‹¬ ì •ë¦¬</h2>
                
                <div class="key-points">
                    <div class="point">
                        <i class="fas fa-star"></i>
                        <h3>ì§€ëŠ¥í˜• ìŠ¤í‚¤ë§ˆ ì„¤ê³„</h3>
                        <p>ë¹„ì¦ˆë‹ˆìŠ¤ ìš”êµ¬ì‚¬í•­ì„ ë¶„ì„í•˜ì—¬ ìµœì ì˜ ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¡°ë¥¼ ìë™ìœ¼ë¡œ ì„¤ê³„í•©ë‹ˆë‹¤.</p>
                    </div>
                    
                    <div class="point">
                        <i class="fas fa-star"></i>
                        <h3>ì¿¼ë¦¬ ìë™ ìµœì í™”</h3>
                        <p>ëŠë¦° ì¿¼ë¦¬ë¥¼ ê°ì§€í•˜ê³  ì¸ë±ìŠ¤ ì¶”ê°€, ì¿¼ë¦¬ ì¬ì‘ì„± ë“±ì˜ ìµœì í™”ë¥¼ ìˆ˜í–‰í•©ë‹ˆë‹¤.</p>
                    </div>
                    
                    <div class="point">
                        <i class="fas fa-star"></i>
                        <h3>í•˜ì´ë¸Œë¦¬ë“œ ì ‘ê·¼</h3>
                        <p>SQLê³¼ NoSQLì˜ ì¥ì ì„ ê²°í•©í•œ ìµœì ì˜ ë°ì´í„° ì €ì¥ ì „ëµì„ ì œì‹œí•©ë‹ˆë‹¤.</p>
                    </div>
                    
                    <div class="point">
                        <i class="fas fa-star"></i>
                        <h3>ìë™í™”ëœ ê´€ë¦¬</h3>
                        <p>ë§ˆì´ê·¸ë ˆì´ì…˜, ë°±ì—…, ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ì„ ìë™í™”í•˜ì—¬ ìš´ì˜ ë¶€ë‹´ì„ ì¤„ì…ë‹ˆë‹¤.</p>
                    </div>
                </div>

                <div class="next-steps">
                    <h3>ë‹¤ìŒ ê°•ì˜ ì˜ˆê³ </h3>
                    <p>ë‹¤ìŒ ê°•ì˜ì—ì„œëŠ” í”„ë¡ íŠ¸ì—”ë“œ í”„ë ˆì„ì›Œí¬ì™€ Cursor AIì˜ í†µí•© í™œìš©ë²•ì„ ë°°ì›ë‹ˆë‹¤.</p>
                    <a href="lesson16.html" class="btn btn-primary">
                        <i class="fas fa-arrow-right"></i> ë‹¤ìŒ ê°•ì˜ë¡œ ì´ë™
                    </a>
                </div>
            </section>
        </main>

        <aside class="sidebar">
            <div class="sidebar-section">
                <h3><i class="fas fa-list"></i> ê°•ì˜ ëª©ì°¨</h3>
                <ol class="lesson-list">
                    <li class="completed">Cursor ì†Œê°œì™€ ì„¤ì¹˜</li>
                    <li class="completed">ì²« ë²ˆì§¸ AI ìë™ì™„ì„±</li>
                    <li class="completed">AI Chat ë§ˆìŠ¤í„°í•˜ê¸°</li>
                    <li class="completed">Cmd+K ì™„ë²½ ê°€ì´ë“œ</li>
                    <li class="completed">í”„ë¡œì íŠ¸ ì»¨í…ìŠ¤íŠ¸</li>
                    <li class="completed">AI ëª¨ë¸ ì„ íƒê³¼ í™œìš©</li>
                    <li class="completed">Composer ê¸°ëŠ¥ í™œìš©</li>
                    <li class="completed">í„°ë¯¸ë„ í†µí•©</li>
                    <li class="completed">ë””ë²„ê¹…ê³¼ ì—ëŸ¬ í•´ê²°</li>
                    <li class="completed">ë‹¨ì¶•í‚¤ì™€ ì„¤ì • ìµœì í™”</li>
                    <li class="completed">Git í†µí•©ê³¼ ë²„ì „ ê´€ë¦¬</li>
                    <li class="completed">í…ŒìŠ¤íŠ¸ ì‘ì„±ê³¼ TDD</li>
                    <li class="completed">ë¦¬íŒ©í† ë§ê³¼ ì½”ë“œ í’ˆì§ˆ</li>
                    <li class="completed">API ê°œë°œê³¼ ë¬¸ì„œí™”</li>
                    <li class="current">ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„ì™€ ìµœì í™”</li>
                </ol>
            </div>

            <div class="sidebar-section">
                <h3><i class="fas fa-database"></i> DB ëª…ë ¹ì–´</h3>
                <div class="command-list">
                    <code>EXPLAIN ANALYZE</code>
                    <code>CREATE INDEX</code>
                    <code>VACUUM FULL</code>
                    <code>ANALYZE</code>
                    <code>\d table_name</code>
                    <code>\di</code>
                </div>
            </div>

            <div class="sidebar-section">
                <h3><i class="fas fa-lightbulb"></i> í”„ë¡œ íŒ</h3>
                <div class="tip-box">
                    <p>ğŸ’¡ ì¸ë±ìŠ¤ëŠ” ë§ŒëŠ¥ì´ ì•„ë‹™ë‹ˆë‹¤. ì“°ê¸° ì„±ëŠ¥ê³¼ ì €ì¥ ê³µê°„ì„ í¬ìƒí•˜ë¯€ë¡œ, ì‹¤ì œë¡œ í•„ìš”í•œ ê³³ì—ë§Œ ìƒì„±í•˜ì„¸ìš”. EXPLAIN ANALYZEë¡œ í•­ìƒ ê²€ì¦í•˜ì„¸ìš”.</p>
                </div>
            </div>
        </aside>

        <div class="progress-tracker">
            <div class="progress-bar" style="width: 50%"></div>
            <span class="progress-text">15/30 ì™„ë£Œ</span>
        </div>
    </div>

    <script src="../assets/lesson-script.js"></script>
</body>
</html>