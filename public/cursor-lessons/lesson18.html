<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì œ18ê°•: Dockerì™€ Kubernetes ë°°í¬ | Cursor AI ë§ˆìŠ¤í„° í´ë˜ìŠ¤</title>
    <link rel="stylesheet" href="../assets/lesson-style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="lesson-container">
        <header class="lesson-header">
            <div class="lesson-title">
                <h1><i class="fas fa-ship"></i> ì œ18ê°•: Dockerì™€ Kubernetes ë°°í¬</h1>
                <p class="lesson-subtitle">AIë¡œ ìë™í™”í•˜ëŠ” ì»¨í…Œì´ë„ˆí™”ì™€ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜</p>
            </div>
            <div class="lesson-meta">
                <span class="difficulty"><i class="fas fa-signal"></i> ë‚œì´ë„: ì¤‘ê¸‰</span>
                <span class="duration"><i class="fas fa-clock"></i> ì˜ˆìƒ ì‹œê°„: 60ë¶„</span>
                <span class="category"><i class="fas fa-folder"></i> ì¹´í…Œê³ ë¦¬: ì¤‘ê¸‰</span>
            </div>
        </header>

        <nav class="lesson-nav">
            <a href="lesson17.html" class="nav-link prev">
                <i class="fas fa-chevron-left"></i> ì´ì „ ê°•ì˜
            </a>
            <span class="nav-title">ì œ18ê°•: Dockerì™€ Kubernetes ë°°í¬</span>
            <a href="lesson19.html" class="nav-link next">
                ë‹¤ìŒ ê°•ì˜ <i class="fas fa-chevron-right"></i>
            </a>
        </nav>

        <main class="lesson-content">
            <section class="learning-objectives">
                <h2><i class="fas fa-bullseye"></i> í•™ìŠµ ëª©í‘œ</h2>
                <ul>
                    <li>AIë¥¼ í™œìš©í•œ Dockerfile ìµœì í™”ì™€ ë©€í‹°ìŠ¤í…Œì´ì§€ ë¹Œë“œ</li>
                    <li>Docker Composeë¡œ ê°œë°œ í™˜ê²½ ìë™ êµ¬ì„±í•˜ê¸°</li>
                    <li>Kubernetes ë§¤ë‹ˆí˜ìŠ¤íŠ¸ ìë™ ìƒì„±ê³¼ ë°°í¬</li>
                    <li>CI/CD íŒŒì´í”„ë¼ì¸ êµ¬ì¶•ê³¼ ìë™í™”</li>
                    <li>ëª¨ë‹ˆí„°ë§ê³¼ ë¡œê¹… ì‹œìŠ¤í…œ êµ¬ì¶•í•˜ê¸°</li>
                </ul>
            </section>

            <section class="content-section">
                <h2><i class="fab fa-docker"></i> Docker ì»¨í…Œì´ë„ˆí™”</h2>
                
                <div class="info-box">
                    <p>Cursor AIëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ íŠ¹ì„±ì„ ë¶„ì„í•˜ì—¬ ìµœì í™”ëœ Docker ì´ë¯¸ì§€ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. ë³´ì•ˆ, í¬ê¸° ìµœì í™”, ë¹Œë“œ ì†ë„ê¹Œì§€ ëª¨ë“  ì¸¡ë©´ì„ ê³ ë ¤í•©ë‹ˆë‹¤.</p>
                </div>

                <h3>ë©€í‹°ìŠ¤í…Œì´ì§€ Dockerfile ìƒì„±</h3>
                <div class="docker-example">
                    <div class="dockerfile-request">
                        <h4>ìš”êµ¬ì‚¬í•­: Node.js ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…Œì´ë„ˆí™”</h4>
                        <p>AIì—ê²Œ ìš”ì²­: "í”„ë¡œë•ì…˜ìš© ìµœì í™”ëœ Node.js Dockerfileì„ ë§Œë“¤ì–´ì¤˜"</p>
                    </div>

                    <div class="ai-generated-dockerfile">
                        <h4>AIê°€ ìƒì„±í•œ Dockerfile</h4>
                        <pre><code># Dockerfile
# ë¹Œë“œ ìŠ¤í…Œì´ì§€
FROM node:18-alpine AS builder

# ë¹Œë“œ ì˜ì¡´ì„± ì„¤ì¹˜
RUN apk add --no-cache python3 make g++

# pnpm ì„¤ì¹˜ (ë” ë¹ ë¥¸ íŒ¨í‚¤ì§€ ê´€ë¦¬)
RUN corepack enable && corepack prepare pnpm@latest --activate

WORKDIR /app

# ì˜ì¡´ì„± íŒŒì¼ë§Œ ë¨¼ì € ë³µì‚¬ (ìºì‹œ ìµœì í™”)
COPY package.json pnpm-lock.yaml* ./

# ì˜ì¡´ì„± ì„¤ì¹˜
RUN pnpm install --frozen-lockfile

# ì†ŒìŠ¤ ì½”ë“œ ë³µì‚¬
COPY . .

# TypeScript ë¹Œë“œ
RUN pnpm run build

# í”„ë¡œë•ì…˜ ì˜ì¡´ì„±ë§Œ ì¬ì„¤ì¹˜
RUN pnpm prune --prod

# ëŸ°íƒ€ì„ ìŠ¤í…Œì´ì§€
FROM node:18-alpine AS runtime

# ë³´ì•ˆì„ ìœ„í•œ non-root ì‚¬ìš©ì ìƒì„±
RUN addgroup -g 1001 -S nodejs && \
    adduser -S nodejs -u 1001

# í•„ìš”í•œ ëŸ°íƒ€ì„ ì˜ì¡´ì„±ë§Œ ì„¤ì¹˜
RUN apk add --no-cache dumb-init

WORKDIR /app

# ë¹Œë“œëœ ì• í”Œë¦¬ì¼€ì´ì…˜ ë³µì‚¬
COPY --from=builder --chown=nodejs:nodejs /app/dist ./dist
COPY --from=builder --chown=nodejs:nodejs /app/node_modules ./node_modules
COPY --from=builder --chown=nodejs:nodejs /app/package.json ./package.json

# í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
ENV NODE_ENV=production
ENV PORT=3000

# í—¬ìŠ¤ì²´í¬ ì¶”ê°€
HEALTHCHECK --interval=30s --timeout=3s --start-period=40s --retries=3 \
    CMD node healthcheck.js

# non-root ì‚¬ìš©ìë¡œ ì „í™˜
USER nodejs

# í¬íŠ¸ ë…¸ì¶œ
EXPOSE 3000

# dumb-initìœ¼ë¡œ í”„ë¡œì„¸ìŠ¤ ê´€ë¦¬
ENTRYPOINT ["dumb-init", "--"]
CMD ["node", "dist/server.js"]</code></pre>
                    </div>

                    <div class="docker-optimization">
                        <h4>.dockerignore íŒŒì¼</h4>
                        <pre><code># .dockerignore
# ê°œë°œ ê´€ë ¨ íŒŒì¼
node_modules
npm-debug.log
yarn-error.log
.pnpm-debug.log

# ë¹Œë“œ ì•„í‹°íŒ©íŠ¸
dist
build
.next
out

# í…ŒìŠ¤íŠ¸ ë° ë¬¸ì„œ
**/*.test.js
**/*.spec.js
coverage
.nyc_output
docs

# ë²„ì „ ê´€ë¦¬
.git
.gitignore
.gitattributes

# IDE ì„¤ì •
.vscode
.idea
*.swp
*.swo
.DS_Store

# í™˜ê²½ ì„¤ì •
.env
.env.*
!.env.example

# CI/CD
.github
.gitlab-ci.yml
.travis.yml

# ê¸°íƒ€
README.md
CHANGELOG.md
docker-compose*.yml
Dockerfile*
.dockerignore</code></pre>
                    </div>

                    <div class="docker-compose">
                        <h4>ê°œë°œ í™˜ê²½ Docker Compose</h4>
                        <pre><code># docker-compose.yml
version: '3.9'

services:
  # ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë¹„ìŠ¤
  app:
    build:
      context: .
      dockerfile: Dockerfile.dev
      args:
        - NODE_ENV=development
    container_name: myapp
    ports:
      - "3000:3000"
      - "9229:9229" # ë””ë²„ê¹… í¬íŠ¸
    volumes:
      - .:/app
      - /app/node_modules # node_modules ì œì™¸
    environment:
      - NODE_ENV=development
      - DATABASE_URL=postgresql://user:password@postgres:5432/myapp
      - REDIS_URL=redis://redis:6379
    depends_on:
      postgres:
        condition: service_healthy
      redis:
        condition: service_started
    networks:
      - app-network
    command: npm run dev

  # PostgreSQL ë°ì´í„°ë² ì´ìŠ¤
  postgres:
    image: postgres:15-alpine
    container_name: myapp-postgres
    ports:
      - "5432:5432"
    environment:
      - POSTGRES_USER=user
      - POSTGRES_PASSWORD=password
      - POSTGRES_DB=myapp
    volumes:
      - postgres-data:/var/lib/postgresql/data
      - ./init-db.sql:/docker-entrypoint-initdb.d/init.sql
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U user -d myapp"]
      interval: 10s
      timeout: 5s
      retries: 5
    networks:
      - app-network

  # Redis ìºì‹œ
  redis:
    image: redis:7-alpine
    container_name: myapp-redis
    ports:
      - "6379:6379"
    command: redis-server --appendonly yes --requirepass redis_password
    volumes:
      - redis-data:/data
    networks:
      - app-network

  # Nginx ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ
  nginx:
    image: nginx:alpine
    container_name: myapp-nginx
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./nginx/nginx.conf:/etc/nginx/nginx.conf:ro
      - ./nginx/ssl:/etc/nginx/ssl:ro
    depends_on:
      - app
    networks:
      - app-network

  # ëª¨ë‹ˆí„°ë§ - Prometheus
  prometheus:
    image: prom/prometheus:latest
    container_name: myapp-prometheus
    ports:
      - "9090:9090"
    volumes:
      - ./monitoring/prometheus.yml:/etc/prometheus/prometheus.yml:ro
      - prometheus-data:/prometheus
    command:
      - '--config.file=/etc/prometheus/prometheus.yml'
      - '--storage.tsdb.path=/prometheus'
    networks:
      - app-network

  # ëª¨ë‹ˆí„°ë§ - Grafana
  grafana:
    image: grafana/grafana:latest
    container_name: myapp-grafana
    ports:
      - "3001:3000"
    environment:
      - GF_SECURITY_ADMIN_PASSWORD=admin
      - GF_USERS_ALLOW_SIGN_UP=false
    volumes:
      - grafana-data:/var/lib/grafana
      - ./monitoring/grafana/dashboards:/etc/grafana/provisioning/dashboards:ro
      - ./monitoring/grafana/datasources:/etc/grafana/provisioning/datasources:ro
    depends_on:
      - prometheus
    networks:
      - app-network

volumes:
  postgres-data:
  redis-data:
  prometheus-data:
  grafana-data:

networks:
  app-network:
    driver: bridge</code></pre>
                    </div>
                </div>
            </section>

            <section class="content-section">
                <h2><i class="fas fa-dharmachakra"></i> Kubernetes ë°°í¬</h2>

                <div class="kubernetes-deployment">
                    <h3>Kubernetes ë§¤ë‹ˆí˜ìŠ¤íŠ¸ ìë™ ìƒì„±</h3>
                    
                    <div class="k8s-deployment">
                        <h4>AIê°€ ìƒì„±í•œ Deployment</h4>
                        <pre><code># deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: myapp
  namespace: production
  labels:
    app: myapp
    version: v1
spec:
  replicas: 3
  strategy:
    type: RollingUpdate
    rollingUpdate:
      maxSurge: 1
      maxUnavailable: 0
  selector:
    matchLabels:
      app: myapp
  template:
    metadata:
      labels:
        app: myapp
        version: v1
      annotations:
        prometheus.io/scrape: "true"
        prometheus.io/port: "3000"
        prometheus.io/path: "/metrics"
    spec:
      serviceAccountName: myapp
      securityContext:
        runAsNonRoot: true
        runAsUser: 1001
        fsGroup: 1001
      containers:
      - name: myapp
        image: myregistry.io/myapp:latest
        imagePullPolicy: Always
        ports:
        - name: http
          containerPort: 3000
          protocol: TCP
        env:
        - name: NODE_ENV
          value: "production"
        - name: PORT
          value: "3000"
        - name: DATABASE_URL
          valueFrom:
            secretKeyRef:
              name: myapp-secrets
              key: database-url
        - name: REDIS_URL
          valueFrom:
            secretKeyRef:
              name: myapp-secrets
              key: redis-url
        resources:
          requests:
            memory: "256Mi"
            cpu: "100m"
          limits:
            memory: "512Mi"
            cpu: "500m"
        livenessProbe:
          httpGet:
            path: /health
            port: http
          initialDelaySeconds: 30
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
        readinessProbe:
          httpGet:
            path: /ready
            port: http
          initialDelaySeconds: 5
          periodSeconds: 5
          timeoutSeconds: 3
          successThreshold: 1
          failureThreshold: 3
        volumeMounts:
        - name: config
          mountPath: /app/config
          readOnly: true
        - name: secrets
          mountPath: /app/secrets
          readOnly: true
      volumes:
      - name: config
        configMap:
          name: myapp-config
      - name: secrets
        secret:
          secretName: myapp-secrets
      affinity:
        podAntiAffinity:
          preferredDuringSchedulingIgnoredDuringExecution:
          - weight: 100
            podAffinityTerm:
              labelSelector:
                matchExpressions:
                - key: app
                  operator: In
                  values:
                  - myapp
              topologyKey: kubernetes.io/hostname</code></pre>
                    </div>

                    <div class="k8s-service">
                        <h4>Serviceì™€ Ingress</h4>
                        <pre><code># service.yaml
apiVersion: v1
kind: Service
metadata:
  name: myapp
  namespace: production
  labels:
    app: myapp
spec:
  type: ClusterIP
  ports:
  - port: 80
    targetPort: http
    protocol: TCP
    name: http
  selector:
    app: myapp
  sessionAffinity: ClientIP
  sessionAffinityConfig:
    clientIP:
      timeoutSeconds: 10800

---
# ingress.yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: myapp
  namespace: production
  annotations:
    kubernetes.io/ingress.class: nginx
    cert-manager.io/cluster-issuer: letsencrypt-prod
    nginx.ingress.kubernetes.io/rate-limit: "100"
    nginx.ingress.kubernetes.io/ssl-redirect: "true"
    nginx.ingress.kubernetes.io/force-ssl-redirect: "true"
    nginx.ingress.kubernetes.io/proxy-body-size: "10m"
    nginx.ingress.kubernetes.io/proxy-connect-timeout: "600"
    nginx.ingress.kubernetes.io/proxy-send-timeout: "600"
    nginx.ingress.kubernetes.io/proxy-read-timeout: "600"
spec:
  tls:
  - hosts:
    - api.myapp.com
    secretName: myapp-tls
  rules:
  - host: api.myapp.com
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: myapp
            port:
              number: 80</code></pre>
                    </div>

                    <div class="k8s-autoscaling">
                        <h4>ìë™ ìŠ¤ì¼€ì¼ë§ ì„¤ì •</h4>
                        <pre><code># hpa.yaml
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: myapp
  namespace: production
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: myapp
  minReplicas: 3
  maxReplicas: 10
  metrics:
  - type: Resource
    resource:
      name: cpu
      target:
        type: Utilization
        averageUtilization: 70
  - type: Resource
    resource:
      name: memory
      target:
        type: Utilization
        averageUtilization: 80
  - type: Pods
    pods:
      metric:
        name: http_requests_per_second
      target:
        type: AverageValue
        averageValue: "1000"
  behavior:
    scaleDown:
      stabilizationWindowSeconds: 300
      policies:
      - type: Pods
        value: 1
        periodSeconds: 60
    scaleUp:
      stabilizationWindowSeconds: 0
      policies:
      - type: Pods
        value: 2
        periodSeconds: 60
      - type: Percent
        value: 100
        periodSeconds: 15

---
# vpa.yaml
apiVersion: autoscaling.k8s.io/v1
kind: VerticalPodAutoscaler
metadata:
  name: myapp
  namespace: production
spec:
  targetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: myapp
  updatePolicy:
    updateMode: "Auto"
  resourcePolicy:
    containerPolicies:
    - containerName: myapp
      minAllowed:
        cpu: 100m
        memory: 128Mi
      maxAllowed:
        cpu: 1
        memory: 1Gi</code></pre>
                    </div>
                </div>
            </section>

            <section class="content-section">
                <h2><i class="fas fa-infinity"></i> CI/CD íŒŒì´í”„ë¼ì¸</h2>

                <div class="cicd-pipeline">
                    <h3>GitHub Actions ì›Œí¬í”Œë¡œìš°</h3>
                    
                    <div class="github-actions">
                        <h4>AIê°€ ìƒì„±í•œ CI/CD íŒŒì´í”„ë¼ì¸</h4>
                        <pre><code># .github/workflows/deploy.yml
name: Build and Deploy

on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main]

env:
  REGISTRY: ghcr.io
  IMAGE_NAME: ${{ github.repository }}

jobs:
  test:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        node-version: [16.x, 18.x, 20.x]
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Use Node.js ${{ matrix.node-version }}
      uses: actions/setup-node@v3
      with:
        node-version: ${{ matrix.node-version }}
        cache: 'npm'
    
    - name: Install dependencies
      run: npm ci
    
    - name: Run linting
      run: npm run lint
    
    - name: Run tests
      run: npm run test:ci
    
    - name: Upload coverage
      uses: codecov/codecov-action@v3
      with:
        token: ${{ secrets.CODECOV_TOKEN }}

  build:
    needs: test
    runs-on: ubuntu-latest
    permissions:
      contents: read
      packages: write
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Set up Docker Buildx
      uses: docker/setup-buildx-action@v2
    
    - name: Log in to Container Registry
      uses: docker/login-action@v2
      with:
        registry: ${{ env.REGISTRY }}
        username: ${{ github.actor }}
        password: ${{ secrets.GITHUB_TOKEN }}
    
    - name: Extract metadata
      id: meta
      uses: docker/metadata-action@v4
      with:
        images: ${{ env.REGISTRY }}/${{ env.IMAGE_NAME }}
        tags: |
          type=ref,event=branch
          type=ref,event=pr
          type=semver,pattern={{version}}
          type=semver,pattern={{major}}.{{minor}}
          type=sha,prefix={{branch}}-
    
    - name: Build and push Docker image
      uses: docker/build-push-action@v4
      with:
        context: .
        push: true
        tags: ${{ steps.meta.outputs.tags }}
        labels: ${{ steps.meta.outputs.labels }}
        cache-from: type=gha
        cache-to: type=gha,mode=max
        platforms: linux/amd64,linux/arm64

  deploy-staging:
    needs: build
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/develop'
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Install kubectl
      uses: azure/setup-kubectl@v3
      with:
        version: 'v1.27.0'
    
    - name: Configure kubectl
      run: |
        mkdir -p ~/.kube
        echo "${{ secrets.KUBE_CONFIG_STAGING }}" | base64 -d > ~/.kube/config
    
    - name: Deploy to staging
      run: |
        kubectl set image deployment/myapp myapp=${{ env.REGISTRY }}/${{ env.IMAGE_NAME }}:develop-${{ github.sha }} -n staging
        kubectl rollout status deployment/myapp -n staging

  deploy-production:
    needs: build
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/main'
    environment:
      name: production
      url: https://api.myapp.com
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Install kubectl
      uses: azure/setup-kubectl@v3
      with:
        version: 'v1.27.0'
    
    - name: Configure kubectl
      run: |
        mkdir -p ~/.kube
        echo "${{ secrets.KUBE_CONFIG_PRODUCTION }}" | base64 -d > ~/.kube/config
    
    - name: Deploy to production
      run: |
        kubectl set image deployment/myapp myapp=${{ env.REGISTRY }}/${{ env.IMAGE_NAME }}:main-${{ github.sha }} -n production
        kubectl rollout status deployment/myapp -n production
    
    - name: Run smoke tests
      run: |
        npm run test:smoke
    
    - name: Notify deployment
      uses: 8398a7/action-slack@v3
      with:
        status: ${{ job.status }}
        text: 'Production deployment completed!'
        webhook_url: ${{ secrets.SLACK_WEBHOOK }}
      if: always()</code></pre>
                    </div>

                    <div class="gitlab-ci">
                        <h4>GitLab CI/CD</h4>
                        <pre><code># .gitlab-ci.yml
stages:
  - test
  - build
  - deploy

variables:
  DOCKER_DRIVER: overlay2
  DOCKER_TLS_CERTDIR: "/certs"
  IMAGE_TAG: $CI_REGISTRY_IMAGE:$CI_COMMIT_SHA

# í…ŒìŠ¤íŠ¸ ìŠ¤í…Œì´ì§€
test:unit:
  stage: test
  image: node:18-alpine
  cache:
    key: ${CI_COMMIT_REF_SLUG}
    paths:
      - node_modules/
  script:
    - npm ci
    - npm run lint
    - npm run test:ci
  coverage: '/Lines\s*:\s*(\d+\.\d+)%/'
  artifacts:
    reports:
      junit: junit.xml
      coverage_report:
        coverage_format: cobertura
        path: coverage/cobertura-coverage.xml

# ë³´ì•ˆ ìŠ¤ìº”
security:scan:
  stage: test
  image: aquasec/trivy:latest
  script:
    - trivy fs --exit-code 1 --severity HIGH,CRITICAL .
  allow_failure: true

# Docker ë¹Œë“œ
build:docker:
  stage: build
  image: docker:latest
  services:
    - docker:dind
  before_script:
    - docker login -u $CI_REGISTRY_USER -p $CI_REGISTRY_PASSWORD $CI_REGISTRY
  script:
    - docker build -t $IMAGE_TAG .
    - docker push $IMAGE_TAG
    - docker tag $IMAGE_TAG $CI_REGISTRY_IMAGE:latest
    - docker push $CI_REGISTRY_IMAGE:latest
  only:
    - main
    - develop

# Kubernetes ë°°í¬
deploy:staging:
  stage: deploy
  image: bitnami/kubectl:latest
  script:
    - kubectl config use-context $KUBE_CONTEXT_STAGING
    - kubectl set image deployment/myapp myapp=$IMAGE_TAG -n staging
    - kubectl rollout status deployment/myapp -n staging
  environment:
    name: staging
    url: https://staging.myapp.com
  only:
    - develop

deploy:production:
  stage: deploy
  image: bitnami/kubectl:latest
  script:
    - kubectl config use-context $KUBE_CONTEXT_PRODUCTION
    - kubectl set image deployment/myapp myapp=$IMAGE_TAG -n production
    - kubectl rollout status deployment/myapp -n production
  environment:
    name: production
    url: https://api.myapp.com
  when: manual
  only:
    - main</code></pre>
                    </div>
                </div>
            </section>

            <section class="content-section">
                <h2><i class="fas fa-chart-line"></i> ëª¨ë‹ˆí„°ë§ê³¼ ë¡œê¹…</h2>

                <div class="monitoring">
                    <h3>Prometheusì™€ Grafana ì„¤ì •</h3>
                    
                    <div class="prometheus-config">
                        <h4>Prometheus ì„¤ì •</h4>
                        <pre><code># prometheus.yml
global:
  scrape_interval: 15s
  evaluation_interval: 15s

alerting:
  alertmanagers:
    - static_configs:
        - targets:
          - alertmanager:9093

rule_files:
  - "alerts/*.yml"

scrape_configs:
  # Kubernetes ì„œë¹„ìŠ¤ ë””ìŠ¤ì»¤ë²„ë¦¬
  - job_name: 'kubernetes-apiservers'
    kubernetes_sd_configs:
    - role: endpoints
    scheme: https
    tls_config:
      ca_file: /var/run/secrets/kubernetes.io/serviceaccount/ca.crt
    bearer_token_file: /var/run/secrets/kubernetes.io/serviceaccount/token
    relabel_configs:
    - source_labels: [__meta_kubernetes_namespace, __meta_kubernetes_service_name, __meta_kubernetes_endpoint_port_name]
      action: keep
      regex: default;kubernetes;https

  # ì•± ë©”íŠ¸ë¦­
  - job_name: 'myapp'
    kubernetes_sd_configs:
    - role: pod
    relabel_configs:
    - source_labels: [__meta_kubernetes_pod_annotation_prometheus_io_scrape]
      action: keep
      regex: true
    - source_labels: [__meta_kubernetes_pod_annotation_prometheus_io_path]
      action: replace
      target_label: __metrics_path__
      regex: (.+)
    - source_labels: [__address__, __meta_kubernetes_pod_annotation_prometheus_io_port]
      action: replace
      regex: ([^:]+)(?::\d+)?;(\d+)
      replacement: $1:$2
      target_label: __address__
    - action: labelmap
      regex: __meta_kubernetes_pod_label_(.+)
    - source_labels: [__meta_kubernetes_namespace]
      action: replace
      target_label: kubernetes_namespace
    - source_labels: [__meta_kubernetes_pod_name]
      action: replace
      target_label: kubernetes_pod_name

  # Node Exporter
  - job_name: 'node-exporter'
    kubernetes_sd_configs:
    - role: node
    relabel_configs:
    - source_labels: [__address__]
      regex: '(.*):10250'
      replacement: '${1}:9100'
      target_label: __address__
    - action: labelmap
      regex: __meta_kubernetes_node_label_(.+)</code></pre>
                    </div>

                    <div class="logging-stack">
                        <h4>ELK Stack ì„¤ì •</h4>
                        <pre><code># fluentd-config.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: fluentd-config
  namespace: kube-system
data:
  fluent.conf: |
    <source>
      @type tail
      path /var/log/containers/*.log
      pos_file /var/log/fluentd-containers.log.pos
      tag kubernetes.*
      read_from_head true
      <parse>
        @type multi_format
        <pattern>
          format json
          time_key time
          time_format %Y-%m-%dT%H:%M:%S.%NZ
        </pattern>
        <pattern>
          format /^(?<time>.+) (?<stream>stdout|stderr) [^ ]* (?<log>.*)$/
          time_format %Y-%m-%dT%H:%M:%S.%N%:z
        </pattern>
      </parse>
    </source>

    <filter kubernetes.**>
      @type kubernetes_metadata
      @id filter_kube_metadata
      kubernetes_url "#{ENV['KUBERNETES_URL']}"
      verify_ssl "#{ENV['KUBERNETES_VERIFY_SSL']}"
      ca_file "#{ENV['KUBERNETES_CA_FILE']}"
      skip_labels false
      skip_container_metadata false
      skip_master_url false
      skip_namespace_metadata false
    </filter>

    <match **>
      @type elasticsearch
      @id out_es
      @log_level info
      include_tag_key true
      host "#{ENV['ELASTICSEARCH_HOST']}"
      port "#{ENV['ELASTICSEARCH_PORT']}"
      scheme "#{ENV['ELASTICSEARCH_SCHEME']}"
      ssl_verify "#{ENV['ELASTICSEARCH_SSL_VERIFY']}"
      ssl_version "#{ENV['ELASTICSEARCH_SSL_VERSION']}"
      user "#{ENV['ELASTICSEARCH_USER']}"
      password "#{ENV['ELASTICSEARCH_PASSWORD']}"
      reload_connections false
      reconnect_on_error true
      reload_on_failure true
      log_es_400_reason false
      logstash_prefix "#{ENV['LOGSTASH_PREFIX']}"
      logstash_dateformat %Y.%m.%d
      type_name "#{ENV['LOGSTASH_PREFIX']}"
      <buffer>
        @type file
        path /var/log/fluentd-buffers/kubernetes.system.buffer
        flush_mode interval
        retry_type exponential_backoff
        flush_thread_count 2
        flush_interval 5s
        retry_forever
        retry_max_interval 30
        chunk_limit_size "#{ENV['OUTPUT_BUFFER_CHUNK_LIMIT']}"
        queue_limit_length "#{ENV['OUTPUT_BUFFER_QUEUE_LIMIT']}"
        overflow_action block
      </buffer>
    </match></code></pre>
                    </div>

                    <div class="alerts">
                        <h4>ì•Œë¦¼ ê·œì¹™</h4>
                        <pre><code># alerts/app-alerts.yml
groups:
  - name: myapp
    interval: 30s
    rules:
      - alert: HighErrorRate
        expr: |
          sum(rate(http_requests_total{status=~"5.."}[5m])) by (service)
          /
          sum(rate(http_requests_total[5m])) by (service)
          > 0.05
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: "High error rate on {{ $labels.service }}"
          description: "Error rate is {{ $value | humanizePercentage }} for {{ $labels.service }}"

      - alert: HighMemoryUsage
        expr: |
          (container_memory_usage_bytes{pod=~"myapp-.*"} / container_spec_memory_limit_bytes) > 0.9
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: "High memory usage on {{ $labels.pod }}"
          description: "Memory usage is {{ $value | humanizePercentage }} for {{ $labels.pod }}"

      - alert: PodCrashLooping
        expr: |
          rate(kube_pod_container_status_restarts_total{pod=~"myapp-.*"}[15m]) > 0
        for: 5m
        labels:
          severity: critical
        annotations:
          summary: "Pod {{ $labels.pod }} is crash looping"
          description: "Pod {{ $labels.pod }} has restarted {{ $value }} times in the last 15 minutes"

      - alert: HighResponseTime
        expr: |
          histogram_quantile(0.95, sum(rate(http_request_duration_seconds_bucket[5m])) by (le, service)) > 1
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: "High response time on {{ $labels.service }}"
          description: "95th percentile response time is {{ $value }}s for {{ $labels.service }}"</code></pre>
                    </div>
                </div>
            </section>

            <section class="practice">
                <h2><i class="fas fa-laptop-code"></i> ì‹¤ìŠµ: ì „ì²´ ë°°í¬ íŒŒì´í”„ë¼ì¸ êµ¬ì¶•</h2>

                <div class="practice-content">
                    <h3>ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ë°°í¬í•˜ê¸°</h3>
                    <p>AIì™€ í•¨ê»˜ ì™„ì „í•œ ë°°í¬ íŒŒì´í”„ë¼ì¸ì„ êµ¬ì¶•í•´ë´…ì‹œë‹¤.</p>

                    <div class="deployment-requirements">
                        <h4>ìš”êµ¬ì‚¬í•­</h4>
                        <ul>
                            <li>3ê°œì˜ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ (API, Worker, Frontend)</li>
                            <li>ê° ì„œë¹„ìŠ¤ë³„ Docker ì´ë¯¸ì§€ ë¹Œë“œ</li>
                            <li>Kubernetes í´ëŸ¬ìŠ¤í„°ì— ë°°í¬</li>
                            <li>ìë™ ìŠ¤ì¼€ì¼ë§ ì„¤ì •</li>
                            <li>ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ êµ¬ì„±</li>
                            <li>CI/CD íŒŒì´í”„ë¼ì¸ êµ¬ì¶•</li>
                        </ul>
                    </div>

                    <div class="deployment-steps">
                        <h4>êµ¬í˜„ ë‹¨ê³„</h4>
                        
                        <div class="step">
                            <h5>1. ì„œë¹„ìŠ¤ ì»¨í…Œì´ë„ˆí™”</h5>
                            <p>Chatì— ìš”ì²­: "3ê°œ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ë¥¼ ìœ„í•œ ìµœì í™”ëœ Dockerfileë“¤ì„ ë§Œë“¤ì–´ì¤˜"</p>
                        </div>
                        
                        <div class="step">
                            <h5>2. Kubernetes ë§¤ë‹ˆí˜ìŠ¤íŠ¸</h5>
                            <p>Cmd+K: "ê° ì„œë¹„ìŠ¤ë³„ Kubernetes deploymentì™€ service ìƒì„±"</p>
                        </div>
                        
                        <div class="step">
                            <h5>3. Helm ì°¨íŠ¸ ìƒì„±</h5>
                            <p>Composerë¡œ Helm ì°¨íŠ¸ êµ¬ì¡° ìƒì„±</p>
                        </div>
                        
                        <div class="step">
                            <h5>4. CI/CD ì„¤ì •</h5>
                            <p>AIì—ê²Œ: "GitHub Actionsë¡œ ì „ì²´ ë°°í¬ ì›Œí¬í”Œë¡œìš° ë§Œë“¤ì–´ì¤˜"</p>
                        </div>
                        
                        <div class="step">
                            <h5>5. ëª¨ë‹ˆí„°ë§ êµ¬ì„±</h5>
                            <p>Prometheusì™€ Grafana ëŒ€ì‹œë³´ë“œ ì„¤ì •</p>
                        </div>
                    </div>

                    <div class="best-practices">
                        <h4>ğŸ† ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤</h4>
                        <ul>
                            <li>ì´ë¯¸ì§€ í¬ê¸° ìµœì†Œí™” (Alpine Linux ì‚¬ìš©)</li>
                            <li>ë ˆì´ì–´ ìºì‹± ìµœì í™”</li>
                            <li>ë³´ì•ˆ ìŠ¤ìº” ìë™í™”</li>
                            <li>ë¸”ë£¨-ê·¸ë¦° ë°°í¬ ì „ëµ</li>
                            <li>ìë™ ë¡¤ë°± ë©”ì»¤ë‹ˆì¦˜</li>
                            <li>ë¹„ë°€ ì •ë³´ ê´€ë¦¬ (Sealed Secrets)</li>
                        </ul>
                    </div>
                </div>
            </section>

            <section class="summary">
                <h2><i class="fas fa-check-circle"></i> í•µì‹¬ ì •ë¦¬</h2>
                
                <div class="key-points">
                    <div class="point">
                        <i class="fas fa-star"></i>
                        <h3>ìµœì í™”ëœ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€</h3>
                        <p>ë©€í‹°ìŠ¤í…Œì´ì§€ ë¹Œë“œì™€ ë³´ì•ˆ ëª¨ë²” ì‚¬ë¡€ë¥¼ ì ìš©í•œ íš¨ìœ¨ì ì¸ Docker ì´ë¯¸ì§€ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.</p>
                    </div>
                    
                    <div class="point">
                        <i class="fas fa-star"></i>
                        <h3>Kubernetes ìë™ êµ¬ì„±</h3>
                        <p>ì• í”Œë¦¬ì¼€ì´ì…˜ íŠ¹ì„±ì— ë§ëŠ” ìµœì ì˜ Kubernetes ë¦¬ì†ŒìŠ¤ë¥¼ ìë™ìœ¼ë¡œ ìƒì„±í•©ë‹ˆë‹¤.</p>
                    </div>
                    
                    <div class="point">
                        <i class="fas fa-star"></i>
                        <h3>ì™„ì „ ìë™í™”ëœ CI/CD</h3>
                        <p>í…ŒìŠ¤íŠ¸ë¶€í„° ë°°í¬ê¹Œì§€ ëª¨ë“  ê³¼ì •ì´ ìë™í™”ëœ íŒŒì´í”„ë¼ì¸ì„ êµ¬ì¶•í•©ë‹ˆë‹¤.</p>
                    </div>
                    
                    <div class="point">
                        <i class="fas fa-star"></i>
                        <h3>ì¢…í•© ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ</h3>
                        <p>ë©”íŠ¸ë¦­, ë¡œê·¸, ì¶”ì ì„ í†µí•©í•œ ì™„ë²½í•œ ê´€ì°° ê°€ëŠ¥ì„±ì„ ì œê³µí•©ë‹ˆë‹¤.</p>
                    </div>
                </div>

                <div class="next-steps">
                    <h3>ë‹¤ìŒ ê°•ì˜ ì˜ˆê³ </h3>
                    <p>ë‹¤ìŒ ê°•ì˜ì—ì„œëŠ” ì„±ëŠ¥ ìµœì í™”ì™€ ë³´ì•ˆ ê°•í™” ë°©ë²•ì„ ë°°ì›ë‹ˆë‹¤.</p>
                    <a href="lesson19.html" class="btn btn-primary">
                        <i class="fas fa-arrow-right"></i> ë‹¤ìŒ ê°•ì˜ë¡œ ì´ë™
                    </a>
                </div>
            </section>
        </main>

        <aside class="sidebar">
            <div class="sidebar-section">
                <h3><i class="fas fa-list"></i> ê°•ì˜ ëª©ì°¨</h3>
                <ol class="lesson-list">
                    <li class="completed">Cursor ì†Œê°œì™€ ì„¤ì¹˜</li>
                    <li class="completed">ì²« ë²ˆì§¸ AI ìë™ì™„ì„±</li>
                    <li class="completed">AI Chat ë§ˆìŠ¤í„°í•˜ê¸°</li>
                    <li class="completed">Cmd+K ì™„ë²½ ê°€ì´ë“œ</li>
                    <li class="completed">í”„ë¡œì íŠ¸ ì»¨í…ìŠ¤íŠ¸</li>
                    <li class="completed">AI ëª¨ë¸ ì„ íƒê³¼ í™œìš©</li>
                    <li class="completed">Composer ê¸°ëŠ¥ í™œìš©</li>
                    <li class="completed">í„°ë¯¸ë„ í†µí•©</li>
                    <li class="completed">ë””ë²„ê¹…ê³¼ ì—ëŸ¬ í•´ê²°</li>
                    <li class="completed">ë‹¨ì¶•í‚¤ì™€ ì„¤ì • ìµœì í™”</li>
                    <li class="completed">Git í†µí•©ê³¼ ë²„ì „ ê´€ë¦¬</li>
                    <li class="completed">í…ŒìŠ¤íŠ¸ ì‘ì„±ê³¼ TDD</li>
                    <li class="completed">ë¦¬íŒ©í† ë§ê³¼ ì½”ë“œ í’ˆì§ˆ</li>
                    <li class="completed">API ê°œë°œê³¼ ë¬¸ì„œí™”</li>
                    <li class="completed">ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„ì™€ ìµœì í™”</li>
                    <li class="completed">í”„ë¡ íŠ¸ì—”ë“œ í”„ë ˆì„ì›Œí¬ì™€ Cursor AI</li>
                    <li class="completed">ë°±ì—”ë“œ í”„ë ˆì„ì›Œí¬ì™€ Cursor AI</li>
                    <li class="current">Dockerì™€ Kubernetes ë°°í¬</li>
                </ol>
            </div>

            <div class="sidebar-section">
                <h3><i class="fas fa-tools"></i> ë°°í¬ ë„êµ¬</h3>
                <div class="deployment-tools">
                    <div class="tool-category">
                        <h4>ì»¨í…Œì´ë„ˆ</h4>
                        <span class="tool-badge">Docker</span>
                        <span class="tool-badge">Podman</span>
                        <span class="tool-badge">Buildah</span>
                    </div>
                    <div class="tool-category">
                        <h4>ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜</h4>
                        <span class="tool-badge">Kubernetes</span>
                        <span class="tool-badge">OpenShift</span>
                        <span class="tool-badge">Nomad</span>
                    </div>
                    <div class="tool-category">
                        <h4>CI/CD</h4>
                        <span class="tool-badge">GitHub Actions</span>
                        <span class="tool-badge">GitLab CI</span>
                        <span class="tool-badge">Jenkins</span>
                    </div>
                </div>
            </div>

            <div class="sidebar-section">
                <h3><i class="fas fa-lightbulb"></i> í”„ë¡œ íŒ</h3>
                <div class="tip-box">
                    <p>ğŸ’¡ Docker ì´ë¯¸ì§€ë¥¼ ë¹Œë“œí•  ë•ŒëŠ” í•­ìƒ .dockerignore íŒŒì¼ì„ ë¨¼ì € ì‘ì„±í•˜ì„¸ìš”. ë¶ˆí•„ìš”í•œ íŒŒì¼ì´ í¬í•¨ë˜ë©´ ì´ë¯¸ì§€ í¬ê¸°ê°€ ì»¤ì§€ê³  ë¹Œë“œ ì‹œê°„ì´ ëŠ˜ì–´ë‚©ë‹ˆë‹¤.</p>
                </div>
            </div>
        </aside>

        <div class="progress-tracker">
            <div class="progress-bar" style="width: 60%"></div>
            <span class="progress-text">18/30 ì™„ë£Œ</span>
        </div>
    </div>

    <script src="../assets/lesson-script.js"></script>
</body>
</html>