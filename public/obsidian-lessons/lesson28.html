<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>제28강: AI 통합과 자동화 | 옵시디언 마스터 클래스</title>
    <link rel="stylesheet" href="../assets/lesson-style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="lesson-container">
        <header class="lesson-header">
            <div class="lesson-title">
                <h1><i class="fas fa-robot"></i> 제28강: AI 통합과 자동화</h1>
                <p class="lesson-subtitle">인공지능으로 지식 관리를 혁신하다</p>
            </div>
            <div class="lesson-meta">
                <span class="difficulty"><i class="fas fa-signal"></i> 난이도: 고급</span>
                <span class="duration"><i class="fas fa-clock"></i> 예상 시간: 65분</span>
                <span class="category"><i class="fas fa-folder"></i> 카테고리: AI & 자동화</span>
            </div>
        </header>

        <nav class="lesson-nav">
            <a href="lesson27.html" class="nav-link prev">
                <i class="fas fa-chevron-left"></i> 이전 강의
            </a>
            <span class="nav-title">제28강: AI 통합과 자동화</span>
            <a href="lesson29.html" class="nav-link next">
                다음 강의 <i class="fas fa-chevron-right"></i>
            </a>
        </nav>

        <main class="lesson-content">
            <section class="learning-objectives">
                <h2><i class="fas fa-bullseye"></i> 학습 목표</h2>
                <ul>
                    <li>AI 플러그인 생태계 이해하고 활용하기</li>
                    <li>LLM(Large Language Model)을 옵시디언과 통합하기</li>
                    <li>스마트 노트 생성과 요약 자동화 구현하기</li>
                    <li>AI 기반 태깅과 분류 시스템 구축하기</li>
                    <li>효과적인 프롬프트 엔지니어링 기법 습득하기</li>
                    <li>고급 자동화 워크플로우 설계하기</li>
                </ul>
            </section>

            <section class="ai-ecosystem">
                <h2><i class="fas fa-network-wired"></i> AI 플러그인 생태계</h2>
                
                <div class="ai-plugins-grid">
                    <div class="plugin-category">
                        <h3><i class="fas fa-brain"></i> LLM 통합 플러그인</h3>
                        <div class="plugin-list">
                            <div class="ai-plugin">
                                <h4>Text Generator</h4>
                                <p>GPT-3/4, Claude와 직접 통합</p>
                                <div class="plugin-features">
                                    <span>텍스트 생성</span>
                                    <span>요약</span>
                                    <span>번역</span>
                                </div>
                            </div>
                            <div class="ai-plugin">
                                <h4>Copilot</h4>
                                <p>컨텍스트 기반 AI 어시스턴트</p>
                                <div class="plugin-features">
                                    <span>대화형 AI</span>
                                    <span>노트 분석</span>
                                    <span>제안</span>
                                </div>
                            </div>
                            <div class="ai-plugin">
                                <h4>Smart Connections</h4>
                                <p>시맨틱 검색과 추천</p>
                                <div class="plugin-features">
                                    <span>유사 노트</span>
                                    <span>자동 링크</span>
                                    <span>클러스터링</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="plugin-category">
                        <h3><i class="fas fa-magic"></i> 자동화 플러그인</h3>
                        <div class="plugin-list">
                            <div class="ai-plugin">
                                <h4>Auto Note Mover</h4>
                                <p>AI 기반 노트 분류</p>
                            </div>
                            <div class="ai-plugin">
                                <h4>Tag Wrangler</h4>
                                <p>스마트 태깅 시스템</p>
                            </div>
                            <div class="ai-plugin">
                                <h4>Note Refactor</h4>
                                <p>자동 노트 분할/병합</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section class="llm-integration">
                <h2><i class="fas fa-comments"></i> LLM 통합 설정</h2>
                
                <h3>OpenAI API 설정</h3>
                
                <div class="setup-guide">
                    <div class="step-by-step">
                        <div class="step">
                            <div class="step-number">1</div>
                            <div class="step-content">
                                <h4>API 키 발급</h4>
                                <p>OpenAI 계정에서 API 키 생성</p>
                            </div>
                        </div>
                        <div class="step">
                            <div class="step-number">2</div>
                            <div class="step-content">
                                <h4>플러그인 설치</h4>
                                <p>Text Generator 플러그인 설치</p>
                            </div>
                        </div>
                        <div class="step">
                            <div class="step-number">3</div>
                            <div class="step-content">
                                <h4>API 키 설정</h4>
                                <p>플러그인 설정에서 API 키 입력</p>
                            </div>
                        </div>
                    </div>
                </div>

                <h3>Text Generator 설정</h3>
                
                <div class="code-example">
                    <div class="code-header">
                        <span class="code-language">JSON Configuration</span>
                        <button class="copy-button">복사</button>
                    </div>
                    <pre><code>{
  "api_key": "sk-...",
  "model": "gpt-4",
  "temperature": 0.7,
  "max_tokens": 2000,
  "templates": {
    "summarize": {
      "prompt": "다음 텍스트를 3줄로 요약해주세요:\n\n{{text}}",
      "temperature": 0.3
    },
    "expand": {
      "prompt": "다음 개념을 상세히 설명해주세요:\n\n{{text}}",
      "temperature": 0.8
    },
    "questions": {
      "prompt": "다음 내용에 대한 심화 질문 5개를 만들어주세요:\n\n{{text}}",
      "temperature": 0.6
    }
  },
  "shortcuts": {
    "summarize": "Ctrl+Shift+S",
    "expand": "Ctrl+Shift+E",
    "generate": "Ctrl+Shift+G"
  }
}</code></pre>
                </div>
            </section>

            <section class="smart-note-generation">
                <h2><i class="fas fa-file-alt"></i> 스마트 노트 생성</h2>
                
                <h3>AI 기반 노트 템플릿</h3>
                
                <div class="code-example">
                    <div class="code-header">
                        <span class="code-language">Smart Template</span>
                        <button class="copy-button">복사</button>
                    </div>
                    <pre><code><%*
// AI 기반 스마트 노트 생성기
const topic = await tp.system.prompt("주제를 입력하세요:");

// AI에 보낼 프롬프트 구성
const prompt = `
주제: ${topic}

다음 구조로 comprehensive한 노트를 작성해주세요:

1. 개요 (2-3문장)
2. 핵심 개념 (3-5개)
3. 상세 설명
4. 실제 예시
5. 관련 개념
6. 추가 학습 자료

마크다운 형식으로 작성하고, 적절한 이모지를 사용하세요.
`;

// AI API 호출
const response = await fetch('https://api.openai.com/v1/chat/completions', {
    method: 'POST',
    headers: {
        'Content-Type': 'application/json',
        'Authorization': `Bearer ${API_KEY}`
    },
    body: JSON.stringify({
        model: 'gpt-4',
        messages: [{
            role: 'user',
            content: prompt
        }],
        temperature: 0.7,
        max_tokens: 2000
    })
});

const data = await response.json();
const content = data.choices[0].message.content;

// 메타데이터 추가
const metadata = `---
created: ${tp.date.now("YYYY-MM-DD HH:mm")}
topic: ${topic}
type: ai-generated
model: gpt-4
tags: [ai-note, ${topic.toLowerCase().replace(/\s+/g, '-')}]
---

`;

tR = metadata + content;
%></code></pre>
                </div>

                <h3>컨텍스트 기반 노트 확장</h3>
                
                <div class="code-example">
                    <div class="code-header">
                        <span class="code-language">Context Expansion</span>
                        <button class="copy-button">복사</button>
                    </div>
                    <pre><code>// 현재 노트의 컨텍스트를 분석하여 확장
async function expandNoteWithContext(note) {
    // 현재 노트의 내용 가져오기
    const content = await app.vault.read(note);
    
    // 연결된 노트들의 컨텍스트 수집
    const links = app.metadataCache.getFileCache(note).links || [];
    let context = "";
    
    for (const link of links.slice(0, 5)) { // 최대 5개 링크
        const linkedFile = app.metadataCache.getFirstLinkpathDest(link.link, note.path);
        if (linkedFile) {
            const linkedContent = await app.vault.read(linkedFile);
            context += `\n관련 노트 "${linkedFile.basename}":\n${linkedContent.slice(0, 500)}...\n`;
        }
    }
    
    // AI 프롬프트 구성
    const prompt = `
현재 노트:
${content}

관련 컨텍스트:
${context}

위 내용을 바탕으로:
1. 추가로 다룰 수 있는 주제 3가지 제안
2. 놓친 중요한 연결고리 지적
3. 심화 학습을 위한 질문 5개 생성
4. 실전 적용 예시 2개 제시

각 섹션은 명확히 구분하여 마크다운으로 작성하세요.
`;
    
    // AI 응답 받기
    const expansion = await callAI(prompt);
    
    // 노트에 추가
    const updatedContent = content + "\n\n---\n\n## 🤖 AI 확장 내용\n\n" + expansion;
    await app.vault.modify(note, updatedContent);
}</code></pre>
                </div>
            </section>

            <section class="ai-summarization">
                <h2><i class="fas fa-compress-alt"></i> AI 요약과 추출</h2>
                
                <h3>계층적 요약 시스템</h3>
                
                <div class="code-example">
                    <div class="code-header">
                        <span class="code-language">Hierarchical Summarization</span>
                        <button class="copy-button">복사</button>
                    </div>
                    <pre><code>class HierarchicalSummarizer {
    constructor(apiKey) {
        this.apiKey = apiKey;
        this.summaryLevels = {
            brief: { maxTokens: 50, temperature: 0.3 },
            standard: { maxTokens: 200, temperature: 0.5 },
            detailed: { maxTokens: 500, temperature: 0.7 }
        };
    }
    
    async summarizeNote(note, level = 'standard') {
        const content = await this.app.vault.read(note);
        const config = this.summaryLevels[level];
        
        const prompt = this.buildSummaryPrompt(content, level);
        const summary = await this.callAI(prompt, config);
        
        // 요약을 노트의 프론트매터에 저장
        await this.saveSummaryToFrontmatter(note, summary, level);
        
        return summary;
    }
    
    buildSummaryPrompt(content, level) {
        const prompts = {
            brief: `한 문장으로 핵심만 요약: ${content}`,
            standard: `3-5개의 중요 포인트로 요약:\n${content}`,
            detailed: `다음 구조로 상세 요약을 작성하세요:
                1. 주요 논점 (3-5개)
                2. 핵심 인사이트
                3. 실행 가능한 포인트
                4. 추가 탐구 영역
                
                내용: ${content}`
        };
        return prompts[level];
    }
    
    async createSummaryIndex(folder) {
        const files = this.app.vault.getMarkdownFiles()
            .filter(f => f.path.startsWith(folder));
        
        let indexContent = `# 📚 ${folder} 요약 인덱스\n\n`;
        indexContent += `생성일: ${moment().format('YYYY-MM-DD HH:mm')}\n\n`;
        
        for (const file of files) {
            const cache = this.app.metadataCache.getFileCache(file);
            const summary = cache?.frontmatter?.summary?.brief || 
                           await this.summarizeNote(file, 'brief');
            
            indexContent += `## [[${file.basename}]]\n`;
            indexContent += `${summary}\n\n`;
            
            // 태그 추가
            if (cache?.tags) {
                indexContent += `태그: ${cache.tags.map(t => t.tag).join(', ')}\n\n`;
            }
        }
        
        // 인덱스 파일 생성
        const indexPath = `${folder}/_Summary_Index.md`;
        await this.app.vault.create(indexPath, indexContent);
    }
}</code></pre>
                </div>

                <h3>핵심 개념 추출</h3>
                
                <div class="code-example">
                    <div class="code-header">
                        <span class="code-language">Concept Extraction</span>
                        <button class="copy-button">복사</button>
                    </div>
                    <pre><code>// AI 기반 핵심 개념 추출기
class ConceptExtractor {
    async extractConcepts(content) {
        const prompt = `
다음 텍스트에서 핵심 개념을 추출하고 분석하세요:

${content}

다음 형식으로 응답하세요:
1. 주요 개념 (최대 10개)
   - 개념명: 간단한 설명
   
2. 개념 간 관계
   - 개념A → 개념B: 관계 설명
   
3. 개념 계층 구조
   - 상위 개념
     - 하위 개념1
     - 하위 개념2

4. 추천 태그 (관련성 높은 순서대로)
`;

        const response = await this.callAI(prompt);
        return this.parseConceptResponse(response);
    }
    
    parseConceptResponse(response) {
        const concepts = {
            main: [],
            relationships: [],
            hierarchy: {},
            tags: []
        };
        
        // 응답 파싱 로직
        const sections = response.split(/\d+\.\s/);
        
        // 주요 개념 파싱
        if (sections[1]) {
            const conceptLines = sections[1].split('\n');
            conceptLines.forEach(line => {
                const match = line.match(/- (.+): (.+)/);
                if (match) {
                    concepts.main.push({
                        name: match[1].trim(),
                        description: match[2].trim()
                    });
                }
            });
        }
        
        return concepts;
    }
    
    async createConceptMap(concepts) {
        let mermaidCode = 'graph TD\n';
        
        // 노드 생성
        concepts.main.forEach((concept, index) => {
            mermaidCode += `    ${index}["${concept.name}"]\n`;
        });
        
        // 관계 추가
        concepts.relationships.forEach(rel => {
            mermaidCode += `    ${rel.from} --> |${rel.type}| ${rel.to}\n`;
        });
        
        return `\`\`\`mermaid\n${mermaidCode}\`\`\``;
    }
}</code></pre>
                </div>
            </section>

            <section class="ai-tagging">
                <h2><i class="fas fa-tags"></i> AI 기반 태깅과 분류</h2>
                
                <h3>스마트 태깅 시스템</h3>
                
                <div class="code-example">
                    <div class="code-header">
                        <span class="code-language">Smart Tagging System</span>
                        <button class="copy-button">복사</button>
                    </div>
                    <pre><code>class SmartTagger {
    constructor() {
        this.tagHierarchy = {
            'technology': ['programming', 'ai', 'web', 'mobile', 'database'],
            'productivity': ['gtd', 'planning', 'habits', 'tools'],
            'learning': ['courses', 'books', 'research', 'skills'],
            'personal': ['health', 'finance', 'relationships', 'hobbies']
        };
    }
    
    async analyzeAndTag(note) {
        const content = await this.app.vault.read(note);
        const metadata = this.app.metadataCache.getFileCache(note);
        
        // 기존 태그 가져오기
        const existingTags = metadata?.tags?.map(t => t.tag) || [];
        
        // AI 분석 요청
        const suggestedTags = await this.getSuggestedTags(content, existingTags);
        
        // 태그 검증 및 계층화
        const validatedTags = this.validateTags(suggestedTags);
        
        // 프론트매터 업데이트
        await this.updateNoteTags(note, validatedTags);
        
        return validatedTags;
    }
    
    async getSuggestedTags(content, existingTags) {
        const prompt = `
콘텐츠: ${content.slice(0, 1000)}

현재 태그: ${existingTags.join(', ')}

위 내용을 분석하여:
1. 적절한 태그 5-10개 제안 (중요도 순)
2. 각 태그의 관련성 점수 (0-100)
3. 태그 카테고리 분류
4. 새로운 태그 제안 이유

응답 형식:
태그명|점수|카테고리|이유
`;

        const response = await this.callAI(prompt);
        return this.parseTagResponse(response);
    }
    
    validateTags(suggestedTags) {
        const validated = [];
        
        suggestedTags.forEach(tag => {
            // 점수 임계값 확인
            if (tag.score < 50) return;
            
            // 중복 제거
            if (validated.some(v => v.name === tag.name)) return;
            
            // 계층 구조 확인
            let category = null;
            for (const [cat, subtags] of Object.entries(this.tagHierarchy)) {
                if (subtags.includes(tag.name)) {
                    category = cat;
                    break;
                }
            }
            
            validated.push({
                ...tag,
                category: category || tag.category,
                hierarchicalTag: category ? `#${category}/${tag.name}` : `#${tag.name}`
            });
        });
        
        return validated;
    }
    
    async updateNoteTags(note, tags) {
        const content = await this.app.vault.read(note);
        const frontmatterRegex = /^---\n([\s\S]*?)\n---/;
        const frontmatterMatch = content.match(frontmatterRegex);
        
        let newFrontmatter = '';
        if (frontmatterMatch) {
            // 기존 프론트매터 업데이트
            const fm = frontmatterMatch[1];
            const tagLine = `tags: [${tags.map(t => t.hierarchicalTag).join(', ')}]`;
            
            if (fm.includes('tags:')) {
                newFrontmatter = fm.replace(/tags:.*/, tagLine);
            } else {
                newFrontmatter = fm + '\n' + tagLine;
            }
        } else {
            // 새 프론트매터 생성
            newFrontmatter = `tags: [${tags.map(t => t.hierarchicalTag).join(', ')}]`;
        }
        
        const updatedContent = content.replace(
            frontmatterRegex,
            `---\n${newFrontmatter}\n---`
        );
        
        await this.app.vault.modify(note, updatedContent);
    }
}</code></pre>
                </div>

                <h3>분류 자동화</h3>
                
                <div class="code-example">
                    <div class="code-header">
                        <span class="code-language">Auto Categorization</span>
                        <button class="copy-button">복사</button>
                    </div>
                    <pre><code>// AI 기반 노트 분류기
class NoteCategorizor {
    constructor() {
        this.categories = {
            'reference': {
                keywords: ['정의', '개념', '이론', 'definition', 'concept'],
                patterns: [/^#+ .+란\?/, /^#+ .+의 정의/]
            },
            'tutorial': {
                keywords: ['방법', '가이드', 'how to', 'tutorial', '따라하기'],
                patterns: [/^#+ .+하는 방법/, /단계별 가이드/]
            },
            'project': {
                keywords: ['프로젝트', '목표', '마감', 'deadline', 'milestone'],
                patterns: [/^#+ 프로젝트:/, /마감일:/]
            },
            'journal': {
                keywords: ['오늘', '일기', '회고', 'today', 'reflection'],
                patterns: [/^\d{4}-\d{2}-\d{2}/, /^#+ 오늘의/]
            }
        };
    }
    
    async categorizeVault() {
        const uncategorized = this.app.vault.getMarkdownFiles()
            .filter(f => !f.path.includes('/') || f.path.startsWith('Inbox/'));
        
        const categorizations = [];
        
        for (const file of uncategorized) {
            const category = await this.determineCategory(file);
            categorizations.push({ file, category });
        }
        
        // 배치 처리
        await this.batchMoveFiles(categorizations);
        
        // 리포트 생성
        await this.generateCategorizationReport(categorizations);
    }
    
    async determineCategory(file) {
        const content = await this.app.vault.read(file);
        const cache = this.app.metadataCache.getFileCache(file);
        
        // 규칙 기반 분류
        let ruleBasedCategory = this.applyRules(content, cache);
        
        if (ruleBasedCategory) {
            return ruleBasedCategory;
        }
        
        // AI 기반 분류
        const aiCategory = await this.getAICategory(content);
        return aiCategory;
    }
    
    applyRules(content, cache) {
        for (const [category, rules] of Object.entries(this.categories)) {
            // 키워드 확인
            const hasKeyword = rules.keywords.some(kw => 
                content.toLowerCase().includes(kw.toLowerCase())
            );
            
            // 패턴 확인
            const matchesPattern = rules.patterns.some(pattern =>
                pattern.test(content)
            );
            
            if (hasKeyword || matchesPattern) {
                return category;
            }
        }
        
        return null;
    }
    
    async getAICategory(content) {
        const prompt = `
다음 노트를 분석하여 가장 적절한 카테고리를 선택하세요:

노트 내용:
${content.slice(0, 500)}...

카테고리 옵션:
- reference: 참고 자료, 정의, 개념 설명
- tutorial: 가이드, 튜토리얼, 방법 설명
- project: 프로젝트 관련 문서
- journal: 일기, 회고, 개인 기록
- resource: 리소스, 링크 모음
- other: 기타

응답 형식:
카테고리: [선택한 카테고리]
신뢰도: [0-100]
이유: [분류 이유]
`;

        const response = await this.callAI(prompt);
        return this.parseCategorizationResponse(response);
    }
}</code></pre>
                </div>
            </section>

            <section class="prompt-engineering">
                <h2><i class="fas fa-terminal"></i> 프롬프트 엔지니어링</h2>
                
                <h3>효과적인 프롬프트 설계</h3>
                
                <div class="prompt-patterns">
                    <div class="pattern-card">
                        <h4>1. 구조화된 출력 요청</h4>
                        <div class="code-example">
                            <pre><code>const structuredPrompt = `
주제: ${topic}

다음 형식으로 정확히 응답해주세요:

## 1. 개요
[2-3문장으로 핵심 요약]

## 2. 주요 개념
- 개념1: [설명]
- 개념2: [설명]
- 개념3: [설명]

## 3. 실전 예시
\`\`\`
[코드 또는 구체적 예시]
\`\`\`

## 4. 관련 링크
- [[관련노트1]]
- [[관련노트2]]

마크다운 형식을 정확히 지켜주세요.
`;</code></pre>
                        </div>
                    </div>

                    <div class="pattern-card">
                        <h4>2. 컨텍스트 제공</h4>
                        <div class="code-example">
                            <pre><code>const contextualPrompt = `
배경 정보:
- 사용자 레벨: ${userLevel}
- 목적: ${purpose}
- 기존 지식: ${priorKnowledge}

작업: ${task}

위 배경을 고려하여 ${userLevel} 수준에 맞게 설명해주세요.
`;</code></pre>
                        </div>
                    </div>

                    <div class="pattern-card">
                        <h4>3. Few-shot 예시</h4>
                        <div class="code-example">
                            <pre><code>const fewShotPrompt = `
다음 예시를 참고하여 유사한 형식으로 작성하세요:

예시 1:
입력: 함수형 프로그래밍
출력: 
- 정의: 함수를 일급 객체로 다루는 프로그래밍 패러다임
- 특징: 불변성, 순수 함수, 고차 함수
- 장점: 예측 가능성, 테스트 용이성

예시 2:
입력: 객체지향 프로그래밍
출력:
- 정의: 객체를 중심으로 프로그램을 구성하는 패러다임
- 특징: 캡슐화, 상속, 다형성
- 장점: 재사용성, 유지보수성

이제 다음에 대해 작성하세요:
입력: ${newTopic}
출력:
`;</code></pre>
                        </div>
                    </div>
                </div>

                <h3>프롬프트 템플릿 라이브러리</h3>
                
                <div class="code-example">
                    <div class="code-header">
                        <span class="code-language">Prompt Templates</span>
                        <button class="copy-button">복사</button>
                    </div>
                    <pre><code>const promptTemplates = {
    // 학습 관련
    explainConcept: {
        template: `
개념: {{concept}}

다음 구조로 설명해주세요:
1. 한 문장 정의
2. 왜 중요한가?
3. 핵심 구성 요소
4. 실생활 비유
5. 일반적인 오해
6. 더 깊이 알아보려면?
`,
        variables: ['concept']
    },
    
    // 문제 해결
    problemSolving: {
        template: `
문제 상황: {{problem}}
제약 조건: {{constraints}}
사용 가능한 리소스: {{resources}}

단계별 해결 방안을 제시하세요:
1. 문제 분석
2. 가능한 접근 방법들
3. 추천 솔루션
4. 구현 단계
5. 예상되는 어려움과 대처 방안
`,
        variables: ['problem', 'constraints', 'resources']
    },
    
    // 코드 생성
    generateCode: {
        template: `
작업: {{task}}
언어: {{language}}
스타일: {{style}}

요구사항:
- 주석 포함
- 에러 처리
- 모범 사례 준수
- 테스트 코드 포함

코드를 생성하고 각 부분을 설명해주세요.
`,
        variables: ['task', 'language', 'style']
    },
    
    // 리서치 지원
    research: {
        template: `
주제: {{topic}}
관점: {{perspective}}
깊이: {{depth}}

다음을 포함하여 리서치 결과를 정리하세요:
1. 현재 상태 (State of the art)
2. 주요 연구자/기관
3. 핵심 발견사항
4. 논란이 되는 부분
5. 미래 전망
6. 추가 조사가 필요한 영역
`,
        variables: ['topic', 'perspective', 'depth']
    }
};

// 프롬프트 빌더 함수
function buildPrompt(templateName, variables) {
    const template = promptTemplates[templateName];
    if (!template) throw new Error(`Template ${templateName} not found`);
    
    let prompt = template.template;
    
    // 변수 치환
    for (const [key, value] of Object.entries(variables)) {
        prompt = prompt.replace(new RegExp(`{{${key}}}`, 'g'), value);
    }
    
    return prompt;
}</code></pre>
                </div>
            </section>

            <section class="automation-workflows">
                <h2><i class="fas fa-cogs"></i> 자동화 워크플로우</h2>
                
                <h3>일일 AI 워크플로우</h3>
                
                <div class="code-example">
                    <div class="code-header">
                        <span class="code-language">Daily AI Workflow</span>
                        <button class="copy-button">복사</button>
                    </div>
                    <pre><code>class DailyAIWorkflow {
    async runDailyRoutine() {
        console.log("🤖 일일 AI 워크플로우 시작...");
        
        // 1. 인박스 처리
        await this.processInbox();
        
        // 2. 일일 요약 생성
        await this.generateDailySummary();
        
        // 3. 연결 제안
        await this.suggestConnections();
        
        // 4. 태그 정리
        await this.cleanupTags();
        
        // 5. 리포트 생성
        await this.generateReport();
        
        console.log("✅ 일일 AI 워크플로우 완료!");
    }
    
    async processInbox() {
        const inboxFiles = this.app.vault.getMarkdownFiles()
            .filter(f => f.path.startsWith('Inbox/'));
        
        for (const file of inboxFiles) {
            // AI 분석
            const analysis = await this.analyzeNote(file);
            
            // 자동 태깅
            await this.autoTag(file, analysis.tags);
            
            // 분류 및 이동
            if (analysis.category !== 'inbox') {
                await this.moveToCategory(file, analysis.category);
            }
            
            // 연결 생성
            await this.createConnections(file, analysis.relatedNotes);
        }
    }
    
    async generateDailySummary() {
        const today = moment().format('YYYY-MM-DD');
        const todaysNotes = this.app.vault.getMarkdownFiles()
            .filter(f => {
                const cache = this.app.metadataCache.getFileCache(f);
                return moment(cache?.frontmatter?.created).format('YYYY-MM-DD') === today;
            });
        
        if (todaysNotes.length === 0) return;
        
        let summaryContent = `# 📊 일일 요약 - ${today}\n\n`;
        summaryContent += `## 📝 생성된 노트 (${todaysNotes.length}개)\n\n`;
        
        for (const note of todaysNotes) {
            const summary = await this.summarizeNote(note, 'brief');
            summaryContent += `### [[${note.basename}]]\n`;
            summaryContent += `${summary}\n\n`;
        }
        
        // AI 인사이트 추가
        const insights = await this.generateInsights(todaysNotes);
        summaryContent += `## 💡 AI 인사이트\n\n${insights}\n`;
        
        // 요약 파일 생성
        const summaryPath = `Daily Summaries/${today}_Summary.md`;
        await this.app.vault.create(summaryPath, summaryContent);
    }
    
    async suggestConnections() {
        // 연결이 부족한 노트 찾기
        const weaklyConnected = this.app.vault.getMarkdownFiles()
            .filter(f => {
                const cache = this.app.metadataCache.getFileCache(f);
                return (cache?.links?.length || 0) < 3;
            })
            .slice(0, 10); // 상위 10개만
        
        const suggestions = [];
        
        for (const note of weaklyConnected) {
            const relatedNotes = await this.findRelatedNotes(note);
            suggestions.push({
                note: note.basename,
                suggestions: relatedNotes.slice(0, 5)
            });
        }
        
        // 제안 파일 생성
        await this.createConnectionSuggestions(suggestions);
    }
    
    async findRelatedNotes(note) {
        const content = await this.app.vault.read(note);
        
        const prompt = `
노트 내용:
${content.slice(0, 1000)}

이 노트와 관련될 수 있는 주제나 개념을 5개 제안하고,
각각에 대해 검색 키워드를 제공하세요.

형식:
주제|키워드1,키워드2,키워드3
`;

        const response = await this.callAI(prompt);
        const topics = this.parseTopicResponse(response);
        
        // 각 주제에 대해 노트 검색
        const relatedNotes = [];
        for (const topic of topics) {
            const searchResults = await this.searchNotes(topic.keywords);
            relatedNotes.push(...searchResults);
        }
        
        return [...new Set(relatedNotes)]; // 중복 제거
    }
}</code></pre>
                </div>

                <h3>AI 플러그인 개발</h3>
                
                <div class="code-example">
                    <div class="code-header">
                        <span class="code-language">AI Plugin Development</span>
                        <button class="copy-button">복사</button>
                    </div>
                    <pre><code>// 기본 AI 플러그인 구조
class AIAssistantPlugin extends Plugin {
    async onload() {
        console.log('AI Assistant 플러그인 로딩...');
        
        // 설정 로드
        await this.loadSettings();
        
        // 명령 등록
        this.registerCommands();
        
        // 이벤트 리스너
        this.registerEventHandlers();
        
        // UI 컴포넌트
        this.addRibbonIcon('bot', 'AI Assistant', () => {
            new AIAssistantModal(this.app, this).open();
        });
        
        // 상태바 아이템
        this.statusBarItem = this.addStatusBarItem();
        this.updateStatusBar();
    }
    
    registerCommands() {
        // AI 요약 명령
        this.addCommand({
            id: 'ai-summarize',
            name: 'AI로 현재 노트 요약',
            editorCallback: async (editor, view) => {
                const content = editor.getValue();
                const summary = await this.aiService.summarize(content);
                
                // 요약을 노트 상단에 삽입
                const summaryBlock = `> [!ai-summary] AI 요약\n> ${summary}\n\n`;
                editor.replaceRange(summaryBlock, {line: 0, ch: 0});
            }
        });
        
        // AI 확장 명령
        this.addCommand({
            id: 'ai-expand',
            name: 'AI로 선택 텍스트 확장',
            editorCallback: async (editor, view) => {
                const selection = editor.getSelection();
                if (!selection) {
                    new Notice('텍스트를 선택하세요');
                    return;
                }
                
                const expanded = await this.aiService.expand(selection);
                editor.replaceSelection(expanded);
            }
        });
        
        // AI 질문 생성
        this.addCommand({
            id: 'ai-questions',
            name: 'AI로 학습 질문 생성',
            callback: async () => {
                const activeFile = this.app.workspace.getActiveFile();
                if (!activeFile) return;
                
                const content = await this.app.vault.read(activeFile);
                const questions = await this.aiService.generateQuestions(content);
                
                // 질문 노트 생성
                const questionNote = `# 학습 질문 - ${activeFile.basename}\n\n${questions}`;
                const questionPath = `Questions/${activeFile.basename}_Questions.md`;
                await this.app.vault.create(questionPath, questionNote);
                
                new Notice('질문 노트가 생성되었습니다');
            }
        });
    }
    
    registerEventHandlers() {
        // 노트 생성 시 자동 처리
        this.registerEvent(
            this.app.vault.on('create', async (file) => {
                if (file instanceof TFile && file.extension === 'md') {
                    if (this.settings.autoProcess) {
                        setTimeout(async () => {
                            await this.processNewNote(file);
                        }, 1000); // 1초 대기
                    }
                }
            })
        );
        
        // 노트 수정 시 태그 업데이트
        this.registerEvent(
            this.app.vault.on('modify', async (file) => {
                if (this.settings.autoTag && 
                    file instanceof TFile && 
                    file.extension === 'md') {
                    // 디바운스 처리
                    if (this.modifyTimeout) {
                        clearTimeout(this.modifyTimeout);
                    }
                    
                    this.modifyTimeout = setTimeout(async () => {
                        await this.updateNoteTags(file);
                    }, 3000); // 3초 대기
                }
            })
        );
    }
    
    async processNewNote(file) {
        const content = await this.app.vault.read(file);
        
        // 내용이 충분한지 확인
        if (content.length < 100) return;
        
        // AI 분석
        const analysis = await this.aiService.analyzeNote(content);
        
        // 메타데이터 추가
        await this.addMetadata(file, {
            tags: analysis.tags,
            summary: analysis.summary,
            category: analysis.category,
            concepts: analysis.concepts
        });
        
        new Notice(`✨ AI 분석 완료: ${file.basename}`);
    }
}</code></pre>
                </div>
            </section>

            <section class="ai-integration-examples">
                <h2><i class="fas fa-code"></i> 실전 통합 예제</h2>
                
                <h3>스마트 리서치 어시스턴트</h3>
                
                <div class="code-example">
                    <div class="code-header">
                        <span class="code-language">Research Assistant</span>
                        <button class="copy-button">복사</button>
                    </div>
                    <pre><code>class ResearchAssistant {
    async conductResearch(topic) {
        console.log(`🔬 "${topic}" 리서치 시작...`);
        
        // 1. 초기 리서치
        const overview = await this.getOverview(topic);
        
        // 2. 관련 논문/자료 검색
        const sources = await this.findSources(topic);
        
        // 3. 핵심 개념 추출
        const concepts = await this.extractConcepts(overview, sources);
        
        // 4. 리서치 노트 생성
        const researchNote = await this.createResearchNote(
            topic, overview, sources, concepts
        );
        
        // 5. 후속 작업 제안
        const nextSteps = await this.suggestNextSteps(topic, concepts);
        
        return {
            noteFile: researchNote,
            concepts: concepts,
            sources: sources,
            nextSteps: nextSteps
        };
    }
    
    async getOverview(topic) {
        const prompt = `
주제: ${topic}

다음을 포함한 종합적인 개요를 작성하세요:
1. 정의와 범위
2. 역사적 배경
3. 현재 상태
4. 주요 이슈와 논란
5. 미래 전망

학술적이면서도 이해하기 쉽게 작성하세요.
`;

        return await this.callAI(prompt);
    }
    
    async createResearchNote(topic, overview, sources, concepts) {
        const template = `# 리서치: ${topic}

생성일: ${moment().format('YYYY-MM-DD HH:mm')}
상태: 초기 리서치
태그: #research #${topic.toLowerCase().replace(/\s+/g, '-')}

## 📋 개요

${overview}

## 🔑 핵심 개념

${concepts.map(c => `### ${c.name}
${c.description}

**관련 개념**: ${c.related.join(', ')}
`).join('\n')}

## 📚 참고 자료

${sources.map(s => `- [${s.title}](${s.url}) - ${s.type}
  - ${s.summary}`).join('\n')}

## 🤔 추가 탐구 질문

${await this.generateResearchQuestions(topic, concepts)}

## 🔗 관련 노트

\`\`\`dataview
LIST
FROM #${topic.toLowerCase().replace(/\s+/g, '-')} OR [[${topic}]]
WHERE file.name != this.file.name
LIMIT 10
\`\`\`

## 📝 리서치 로그

### ${moment().format('YYYY-MM-DD')}
- 초기 리서치 완료
- 핵심 개념 ${concepts.length}개 식별
- 참고 자료 ${sources.length}개 수집

---

## 🎯 다음 단계

${(await this.suggestNextSteps(topic, concepts)).map(step => `- [ ] ${step}`).join('\n')}
`;

        const filePath = `Research/${topic.replace(/[\\/:*?"<>|]/g, '_')}.md`;
        const file = await this.app.vault.create(filePath, template);
        
        return file;
    }
}</code></pre>
                </div>

                <h3>학습 코치 시스템</h3>
                
                <div class="code-example">
                    <div class="code-header">
                        <span class="code-language">Learning Coach</span>
                        <button class="copy-button">복사</button>
                    </div>
                    <pre><code>class LearningCoach {
    async analyzeLearningProgress(subject) {
        const notes = await this.getLearningNotes(subject);
        const progress = await this.calculateProgress(notes);
        const recommendations = await this.getRecommendations(progress);
        
        return this.createProgressReport(subject, progress, recommendations);
    }
    
    async calculateProgress(notes) {
        const metrics = {
            notesCreated: notes.length,
            totalWords: 0,
            conceptsCovered: new Set(),
            questionsAnswered: 0,
            practiceCompleted: 0,
            connections: 0
        };
        
        for (const note of notes) {
            const content = await this.app.vault.read(note);
            const cache = this.app.metadataCache.getFileCache(note);
            
            metrics.totalWords += content.split(/\s+/).length;
            metrics.connections += (cache?.links?.length || 0);
            
            // 체크박스 완료율
            const checkboxes = content.match(/- \[[ x]\]/g) || [];
            const completed = content.match(/- \[x\]/g) || [];
            metrics.practiceCompleted += completed.length / (checkboxes.length || 1);
            
            // 개념 추출
            const concepts = await this.extractConcepts(content);
            concepts.forEach(c => metrics.conceptsCovered.add(c));
        }
        
        // AI 분석으로 이해도 평가
        const understanding = await this.assessUnderstanding(notes);
        
        return {
            ...metrics,
            conceptsCovered: Array.from(metrics.conceptsCovered),
            understandingLevel: understanding,
            progressScore: this.calculateScore(metrics, understanding)
        };
    }
    
    async getRecommendations(progress) {
        const prompt = `
학습 진행 상황:
- 작성 노트: ${progress.notesCreated}개
- 다룬 개념: ${progress.conceptsCovered.length}개
- 이해도: ${progress.understandingLevel}/100
- 연결성: ${progress.connections}개

다음을 추천해주세요:
1. 다음에 학습할 주제 (3개)
2. 복습이 필요한 개념 (있다면)
3. 실습 프로젝트 아이디어
4. 학습 방법 개선 제안

각 추천에 대한 이유도 설명해주세요.
`;

        const response = await this.callAI(prompt);
        return this.parseRecommendations(response);
    }
    
    createProgressReport(subject, progress, recommendations) {
        return `# 🎓 학습 진행 리포트: ${subject}

생성일: ${moment().format('YYYY-MM-DD HH:mm')}

## 📊 진행 상황 요약

\`\`\`chart
type: radar
labels: [노트 작성, 개념 이해, 실습 완료, 연결성, 전반적 이해도]
series:
  - title: 현재 수준
    data: [${progress.notesCreated * 10}, ${progress.understandingLevel}, ${progress.practiceCompleted * 100}, ${progress.connections * 5}, ${progress.progressScore}]
  - title: 목표 수준
    data: [100, 100, 100, 100, 100]
\`\`\`

## 📈 상세 지표

- **작성한 노트**: ${progress.notesCreated}개
- **총 학습량**: ${progress.totalWords.toLocaleString()} 단어
- **다룬 개념**: ${progress.conceptsCovered.length}개
- **이해도 점수**: ${progress.understandingLevel}/100
- **진행률**: ${progress.progressScore}%

## 🎯 AI 추천 사항

### 다음 학습 주제
${recommendations.nextTopics.map((t, i) => `
${i + 1}. **${t.topic}**
   - 이유: ${t.reason}
   - 예상 소요 시간: ${t.estimatedTime}
`).join('')}

### 복습 필요 개념
${recommendations.reviewNeeded.length > 0 ? 
  recommendations.reviewNeeded.map(r => `- ${r.concept}: ${r.reason}`).join('\n') :
  '현재 복습이 필요한 개념이 없습니다. 훌륭합니다! 👏'}

### 실습 프로젝트
${recommendations.projects.map((p, i) => `
**프로젝트 ${i + 1}: ${p.title}**
- 난이도: ${p.difficulty}
- 설명: ${p.description}
- 학습 목표: ${p.learningGoals.join(', ')}
`).join('\n')}

### 학습 방법 개선
${recommendations.improvements.map(imp => `- ${imp}`).join('\n')}

## 🗓️ 학습 계획

### 이번 주 목표
- [ ] ${recommendations.weeklyGoals[0]}
- [ ] ${recommendations.weeklyGoals[1]}
- [ ] ${recommendations.weeklyGoals[2]}

### 장기 로드맵
\`\`\`mermaid
graph LR
    A[현재: ${subject} 기초] --> B[2주 후: 중급 개념]
    B --> C[1개월 후: 실전 프로젝트]
    C --> D[2개월 후: 고급 주제]
    D --> E[3개월 후: 전문가 수준]
\`\`\`

---

_다음 리포트 생성 예정일: ${moment().add(1, 'week').format('YYYY-MM-DD')}_
`;
    }
}</code></pre>
                </div>
            </section>

            <section class="practice-exercise">
                <h2><i class="fas fa-dumbbell"></i> 실습 과제</h2>
                
                <div class="exercise-container">
                    <h3>기본 실습</h3>
                    <div class="checklist">
                        <label><input type="checkbox"> Text Generator 플러그인 설치 및 설정</label>
                        <label><input type="checkbox"> AI로 노트 요약 생성하기</label>
                        <label><input type="checkbox"> 스마트 태깅 시스템 구현</label>
                        <label><input type="checkbox"> 프롬프트 템플릿 3개 작성</label>
                        <label><input type="checkbox"> 일일 AI 워크플로우 설정</label>
                        <label><input type="checkbox"> AI 기반 노트 분류 실행</label>
                    </div>

                    <h3>심화 과제</h3>
                    <div class="challenge-box">
                        <h4><i class="fas fa-trophy"></i> AI 파워드 PKM 구축</h4>
                        <p>AI를 활용한 완전 자동화 지식 관리 시스템을 구축하세요:</p>
                        <ol>
                            <li><strong>자동 캡처 시스템</strong>
                                <ul>
                                    <li>웹 클리핑 → AI 요약 → 자동 분류</li>
                                    <li>음성 메모 → 텍스트 변환 → 노트 생성</li>
                                </ul>
                            </li>
                            <li><strong>지능형 처리</strong>
                                <ul>
                                    <li>AI 태깅 및 분류</li>
                                    <li>자동 연결 생성</li>
                                    <li>중복 감지 및 병합</li>
                                </ul>
                            </li>
                            <li><strong>학습 지원</strong>
                                <ul>
                                    <li>개인화된 학습 경로</li>
                                    <li>AI 퀴즈 생성</li>
                                    <li>진도 추적 및 추천</li>
                                </ul>
                            </li>
                            <li><strong>창의적 활용</strong>
                                <ul>
                                    <li>AI 브레인스토밍</li>
                                    <li>아이디어 연결 및 확장</li>
                                    <li>콘텐츠 생성 지원</li>
                                </ul>
                            </li>
                        </ol>
                    </div>
                </div>
            </section>

            <section class="troubleshooting">
                <h2><i class="fas fa-tools"></i> 문제 해결</h2>
                
                <div class="faq-container">
                    <div class="faq-item">
                        <h3><i class="fas fa-question-circle"></i> API 한도 초과 오류</h3>
                        <ul>
                            <li>요청 빈도 제한 설정</li>
                            <li>캐싱 시스템 구현</li>
                            <li>배치 처리로 전환</li>
                            <li>여러 API 키 로테이션</li>
                        </ul>
                    </div>
                    <div class="faq-item">
                        <h3><i class="fas fa-question-circle"></i> AI 응답이 부정확해요</h3>
                        <ul>
                            <li>프롬프트 구체화</li>
                            <li>Few-shot 예시 추가</li>
                            <li>컨텍스트 정보 제공</li>
                            <li>모델 파라미터 조정</li>
                        </ul>
                    </div>
                    <div class="faq-item">
                        <h3><i class="fas fa-question-circle"></i> 자동화가 너무 느려요</h3>
                        <ul>
                            <li>비동기 처리 구현</li>
                            <li>우선순위 큐 사용</li>
                            <li>증분 처리 방식 적용</li>
                            <li>백그라운드 작업으로 전환</li>
                        </ul>
                    </div>
                </div>
            </section>

            <section class="summary">
                <h2><i class="fas fa-book-reader"></i> 핵심 정리</h2>
                <div class="summary-grid">
                    <div class="summary-item">
                        <i class="fas fa-brain"></i>
                        <h3>지능형 노트</h3>
                        <p>AI로 노트가 스스로 진화하고 연결됩니다</p>
                    </div>
                    <div class="summary-item">
                        <i class="fas fa-magic"></i>
                        <h3>자동화의 힘</h3>
                        <p>반복 작업은 AI에게, 창의적 사고는 인간에게</p>
                    </div>
                    <div class="summary-item">
                        <i class="fas fa-rocket"></i>
                        <h3>증강된 사고</h3>
                        <p>AI는 도구일 뿐, 주체는 여전히 당신입니다</p>
                    </div>
                </div>
            </section>

            <section class="navigation-guide">
                <h2><i class="fas fa-compass"></i> 다음 단계</h2>
                <p>AI 통합과 자동화를 마스터했다면, 다음 강의에서는 더욱 고급 워크플로우와 엔터프라이즈 수준의 구현에 대해 배워보겠습니다.</p>
                <div class="next-lesson-preview">
                    <h3>다음 강의 미리보기: 고급 워크플로우</h3>
                    <ul>
                        <li>복잡한 워크플로우 설계</li>
                        <li>다중 도구 통합</li>
                        <li>팀 협업 시스템</li>
                    </ul>
                </div>
            </section>
        </main>

        <footer class="lesson-footer">
            <div class="footer-content">
                <p>옵시디언 마스터 클래스 | 제28강: AI 통합과 자동화</p>
                <div class="footer-links">
                    <a href="../index.html"><i class="fas fa-home"></i> 홈</a>
                    <a href="lesson27.html"><i class="fas fa-arrow-left"></i> 이전</a>
                    <a href="lesson29.html"><i class="fas fa-arrow-right"></i> 다음</a>
                </div>
            </div>
        </footer>
    </div>

    <script src="../assets/lesson-script.js"></script>
</body>
</html>